(self.webpackChunk=self.webpackChunk||[]).push([[467],{2081:(t,e,n)=>{"use strict";n.r(e);var r=n(1474);const i=function(t){return{orderUrl:t.url||"",sortable:null,init:function(){var t=this;this.sortable=r.ZP.create(this.$refs.sortableRef,{handle:".handler",animation:150,onUpdate:function(e){var n=t.sortable.toArray();axios.post(t.orderUrl,{order:n}).catch((function(t){console.log(t)}))}})}}};var a=n(7757),o=n.n(a);function s(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function c(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){s(a,r,i,o,c,"next",t)}function c(t){s(a,r,i,o,c,"throw",t)}o(void 0)}))}}function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const h=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{expanded:!1};return d(d({},e.share||{}),{},{locales:(null===(t=e.share)||void 0===t?void 0:t.locales)||[],trans_locale:document.documentElement.lang||"uk",trans_expanded:e&&e.expanded,submit:function(t,e){var n=this;return c(o().mark((function t(){var r,i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=!0,n.$refs.form.querySelectorAll(":invalid").forEach((function(t){t.validity.valid||(r=!1,toast.error("Поле "+t.name+" має не вірне значення"))})),r?e?n.$refs.form.submit():(i=jQuery('<button type="submit" class="d-none"></button>'),jQuery(n.$refs.form).append(i),i.click()):toast.error("Перевірте правильність заповнення полів");case 4:case"end":return t.stop()}}),t)})))()}})};var m=n(9669),p=n.n(m);function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var g=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(e){var n=e.split("?");t=n.length>1?n[1]:""}else t=document.location.search.replace("?","");var r=t.split("&")||[],i={};return r.forEach((function(t){var e=t.split("=");e[0].length&&(i[e[0]]=decodeURIComponent(e[1]))})),i},v=function t(e,n){var r,i=[];for(r in e)if(e.hasOwnProperty(r)){var a=n?n+"["+r+"]":r,o=e[r];if(null!==o&&"object"===f(o)){var s=t(o,a);s.length&&i.push(s)}else i.push(encodeURIComponent(a)+"="+encodeURIComponent(o))}return i.join("&")},y=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={};for(var r in t)if(t[r]){if(e.hasOwnProperty(r)&&e[r]===t[r])continue;n[r]=t[r]}return n},b=function(){return document.location.pathname+document.location.search},w=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=v(e);return n.length>0&&(t+="?"+n),t},j=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=decodeURIComponent(w(t,e));return(!n||i!==b())&&(r?window.history.replaceState(null,null,i):window.history.pushState(null,null,i),i)},O=n(8926),D=null;const x=function(t){return{loading:!1,locales:t.locales||["uk"],links:[],items:[],group:t.params.group||"*",order:t.params.order||"key:asc",q:decodeURIComponent(t.params.q||""),current_page:parseInt(t.params.page)||1,selectedItem:{id:0,group:"",key:"",text:{uk:""}},init:function(){var t=this;this.loadItems(!1),this.$watch("q",(function(){t.filterChange()}))},get modal(){return bootstrap.Modal.getOrCreateInstance(document.getElementById("edit-line-modal"))},get filterData(){return{q:this.q,group:this.group,order:this.sort,page:this.current_page}},get defaultFilter(){return{q:"",group:"*",order:"key:desc",page:1}},loadItems:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];D&&D.cancel(),D=p().CancelToken.source(),this.loading=!0;var n=this.filterData;if(e){var r=y(n,this.defaultFilter);j(document.location.pathname,r,!1)}p().get("",{cancelToken:D.token,params:n}).then((function(e){var n=e.data;t.items=n.data,t.links=n.links,t.loading=!1})).catch((function(e){console.log(e),t.loading=!1}))},setPage:function(t){var e=g(t);this.current_page=e.page||1,this.loadItems(!0)},setSorting:function(t){this.sort=t,this.loadItems(!0)},filterChange:function(){this.current_page=1,this.loadItems()},editItem:function(t){this.selectedItem=Object.assign({id:0,group:"",key:"",text:{uk:""}},t),this.modal.show()},cancelEdit:function(){this.modal.hide()},saveItem:function(){var t=this;this.selectedItem.id>0||this.selectedItem.id;this.selectedItem.id>0?p().patch("/admin/translation/"+this.selectedItem.id,{text:this.selectedItem.text}).then((function(e){var n=e.data;if("success"===n.result){var r=t.items.findIndex((function(e){return e.id===t.selectedItem.id}));t.items[r]=n.model,O.A.success("Запис оновлено")}})).catch((function(t){console.log(t),O.A.error(t.message)})):p().post("/admin/translation",{group:this.selectedItem.group,key:this.selectedItem.key,text:this.selectedItem.text}).then((function(){t.loadItems(),O.A.success("Запис створено")})).catch((function(t){console.log(t),O.A.error(t.message)})),this.modal.hide()}}};function S(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}const A=function(t){return{checked:t.checked||!1,change:function(){var e,n=this;return(e=o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.$refs.checkboxEl.disabled=!0,e.next=3,axios.patch(t.url,{published:n.checked?1:0});case 3:n.$refs.checkboxEl.disabled=!1,n.checked?toast.success("Запис опубліковано"):toast.success("Запис знятий з публікації");case 5:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(t){S(a,r,i,o,s,"next",t)}function s(t){S(a,r,i,o,s,"throw",t)}o(void 0)}))})()}}};function k(t){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function C(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function I(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){C(a,r,i,o,s,"next",t)}function s(t){C(a,r,i,o,s,"throw",t)}o(void 0)}))}}const P=function(t){return{locale:document.documentElement.lang||"uk",items:t.items||[],collection:t.collection||"default",storeUrl:t.storeUrl||"/admin/media/upload",updateUrl:t.updateUrl||"/admin/media/0",destroyUrl:t.destroyUrl||"/admin/media/0",orderUrl:t.orderUrl||"/admin/media/order",mediaName:t.mediaName||"media_file",sortable:null,init:function(){var t=this;this.sortable=r.ZP.create(this.$refs.sortableRef,{handle:".handler",animation:150,onUpdate:function(e){var n=t.sortable.toArray();n.splice(0,1),axios.post(t.orderUrl,{order:n}).catch((function(t){console.log(t)}))}})},onChange:function(t){console.log(t)},clear:function(){this.value=""},onFileChange:function(){var t=this;return I(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=t.$refs.fileRef.files).length>0&&(n.forEach((function(e){"object"===k(e)&&t.uploadMedia(e)})),t.$refs.fileRef.value=null);case 2:case"end":return e.stop()}}),e)})))()},uploadMedia:function(t){var e=this;return I(o().mark((function n(){var r,i,a;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=new FileReader,i={id:0,name:t.name,loader:!0,alt:{},title:{}},r.onload=function(t){i.thumb=t.target.result,e.items.push(i)},t&&e.storeUrl&&"#"!==e.storeUrl){n.next=5;break}return n.abrupt("return");case 5:return r.readAsDataURL(t),(a=new FormData).append(e.mediaName,t),a.append("collection",e.collection),a.append("custom_properties[published]","true"),n.next=12,axios.post(e.storeUrl,a,{headers:{"Content-Type":"multipart/form-data"}}).then((function(t){var n=t.data;if("success"===n.result){var r=e.items.findIndex((function(t){return t.name===i.name}));r>-1&&(e.items[r]=n.media)}})).catch((function(t){i.error="Upload Error",console.log(t)}));case 12:case"end":return n.stop()}}),n)})))()},deleteMediaItem:function(t){var e=this;return I(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.destroyUrl&&"#"!==e.destroyUrl){n.next=2;break}return n.abrupt("return");case 2:axios.delete(e.destroyUrl.replace("0",t.id)).then((function(n){if("success"===n.data.result){var r=e.items.findIndex((function(e){return e.id===t.id}));r>-1&&e.items.splice(r,1)}})).catch((function(e){t.error="Delete Error",console.log(e)}));case 3:case"end":return n.stop()}}),n)})))()},updateMedia:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.updateUrl&&"#"!==this.updateUrl&&axios.patch(this.updateUrl.replace("0",t.id),e).then((function(t){t.data.result})).catch((function(e){t.error="Update Error",console.log(e)}))},updateMediaTitle:function(t){var e=t.title[this.locale]||"";this.updateMedia(t,{title:e,locale:this.locale})},updateMediaAlt:function(t){var e=t.alt[this.locale]||"";this.updateMedia(t,{alt:e,locale:this.locale})},toggleMediaItem:function(t){this.updateMedia(t,{published:!!t.published})}}};var E=n(7575),M=n.n(E);function T(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function q(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){T(a,r,i,o,s,"next",t)}function s(t){T(a,r,i,o,s,"throw",t)}o(void 0)}))}}var L=function(){var t=q(o().mark((function t(e,n,r,i){var a,s;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(a=new XMLHttpRequest).withCredentials=!1,a.open("POST",e),a.setRequestHeader("X-CSRF-TOKEN",document.head.querySelector('meta[name="csrf-token"]').content),a.onload=function(){var t;200===a.status?(t=JSON.parse(a.responseText))&&"string"==typeof t.location?r(t.location):i("Invalid JSON: "+a.responseText):i("HTTP Error: "+a.status)},(s=new FormData).append("file",n.blob(),n.filename()),a.send(s);case 8:case"end":return t.stop()}}),t)})));return function(e,n,r,i){return t.apply(this,arguments)}}();const U=function(t){return{editor:null,value:"",init:function(){var e=this;this.value=this.$refs.valueRef.value;var n,r="#"+this.$refs.valueRef.getAttribute("id"),i=document.documentElement.lang||"uk";this.editor=M().init({content_css:"/css/editor.css",selector:r,language:i,plugins:["advlist autolink link image lists charmap print preview hr anchor pagebreak","searchreplace wordcount visualblocks visualchars code fullscreen insertdatetime media nonbreaking","table emoticons template paste help"],toolbar:"undo redo | styleselect | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image | preview media fullpage | forecolor backcolor emoticons | help | customInsertButton customDateButton",menubar:"favs file edit view insert format tools table help",images_upload_handler:(n=q(o().mark((function e(n,r,i){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L(t.uploadUrl,n,r,i);case 2:case"end":return e.stop()}}),e)}))),function(t,e,r){return n.apply(this,arguments)}),setup:function(t){t.on("Input",(function(n){e.value=t.getContent()})),t.on("Change",(function(n){e.value=t.getContent()})),t.ui.registry.addButton("customInsertButton",{text:"Html Block",onAction:function(e){var n=$('<select id="s2" class="form-control"></select>');$(".tox-menubar").append(n),$("#s2").select2({theme:"bootstrap-5",ajax:{url:"/api/html-blocks",dataType:"json",quietMillis:500,data:function(t){return self.prevQuery=t,{q:t.term,page:t.page||1,limit:20}}}}),$("#s2").on("select2:select",(function(e){t.insertContent("{{"+e.params.data.id+"}}")})),$("#s2").select2("open")}})}})}}},B=function(t){return{value:t.value,onChange:function(t){console.log(t)},clear:function(){this.value="",this.$refs.fileInputRef.value=""}}},F=function(t){return{locales:t.locales||[],place:t.place||null,model:t.model||null,regions:t.regions||[],districts:t.districts||[],places:t.places||[],options:[],prevSearchQuery:"",prevQuery:{},prevResults:{},init:function(){var t=this,e=this;this.$watch("model.place_id",(function(e){return t.onPlaceChange(e)})),jQuery(this.$refs.input).select2({theme:"bootstrap-5",dataCache:[],ajax:{url:"/api/places/select-box",dataType:"json",quietMillis:500,data:function(t){return e.prevQuery=t,{region_id:jQuery("#region_id").val(),district_id:jQuery("#district_id").val(),q:t.term,page:t.page||1,limit:20}},processResults:function(t){return t},success:function(t){e.prevResults=t.results}}}),jQuery(this.$refs.input).on("select2:closing",(function(t){e.prevSearchQuery=jQuery(".select2-search input").prop("value")})),jQuery(this.$refs.input).on("select2:open",(function(t){jQuery(".select2-search input").val(e.prevSearchQuery).trigger("input")})),jQuery(this.$refs.input).on("select2:select",(function(t){e.model.place_id=t.params.data.id}))},onPlaceChange:function(t){var e=this;axios.get("/api/places/get",{params:{place_id:t}}).then((function(t){e.place=t.data}))},onChange:function(t){this.model.place_id=t.target.value},clear:function(){this.model.place_id=0}}},Y=function(t){return{locales:t.locales||[],ticket:t.ticket||null,model:t.model||null,regions:t.regions||[],tickets:t.tickets||[],init:function(){var t=this,e=this;this.$watch("model.ticket_id",(function(e){return t.onTicketChange(e)})),jQuery(this.$refs.input).select2({theme:"bootstrap-5",ajax:{url:"/api/tickets/select-box",dataType:"json",data:function(t){return{region_id:jQuery("#region_id").val(),q:t.term,page:t.page||1,limit:20}}}}),jQuery(this.$refs.input).on("select2:select",(function(t){e.model.ticket_id=t.params.data.id,console.log(e.model)}))},onTicketChange:function(t){var e=this;axios.get("/api/tickets/get",{params:{ticket_id:t}}).then((function(t){e.ticket=t.data}))},onChange:function(t){this.model.ticket_id=t.target.value},clear:function(){this.model.ticket_id=0}}},R=function(t){return{value:t.value,init:function(){var t=this;jQuery(this.$refs.input).select2({theme:"bootstrap-5"}),jQuery(this.$refs.input).on("select2:select",(function(e){t.value=e.params.data.id}))},onChange:function(t){this.value=t.target.value},clear:function(){this.value=0}}},Q=function(t){if(t.response)if(422===t.response.status)for(var e in t.response.data.errors){var n=t.response.data.errors[e];toast.error(n)}else toast.error(t.response.data.message);else t.request?console.log(t.request):(console.log("Error",t.message),toast.error(t.message))};var Z=null;const z=function(t){var e=t.url,n=t.params,r=void 0===n?{}:n,i=t.updateUrl,a=void 0===i||i,o=t.defaultParams,s=void 0===o?{}:o,c=t.onSuccess,u=void 0===c?null:c,d=t.onError,l=void 0===d?null:d;if(Z&&Z.cancel(),Z=p().CancelToken.source(),a){var h=y(r,s);j(document.location.pathname,h,!1)}p().get(e,{cancelToken:Z.token,params:r}).then((function(t){var e=t.data;u&&u(e)})).catch((function(t){Q(t),l&&l(t)}))},N=function(t){var e=t.url,n=t.params,r=void 0===n?{}:n,i=t.onSuccess,a=void 0===i?null:i,o=t.onError,s=void 0===o?null:o;p().patch(e,r).then((function(t){var e=t.data;a&&a(e)})).catch((function(t){Q(t),s&&s(t)}))},H=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Swal.fire({text:"Ви впевнені?",icon:"warning",showCancelButton:!0,confirmButtonText:"Так",cancelButtonText:"Відмінити"}).then((function(n){n.value&&p().delete(t).then((function(t){var n=t.data;e&&e(n),toast.success(n.message)})).catch((function(t){Q(t)}))}))};var W=n(8187),G=n(1193),V=(n(3550),n(381)),K=n.n(V);function X(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function J(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?X(Object(n),!0).forEach((function(e){tt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function tt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var et={id:0,start_date:"",places:48,price:null,commission:null,accomm_price:null,curren:"UAH",comment:"",auto_booking:!1,auto_limit:10,repeat:"",repeat_count:1,repeat_custom_interval:"all",repeat_day_of_week:"saturday"};const nt=function(t){return{tour:t.tour,canEdit:t.canEdit||!1,scheduleData:J({},et),q:t.params.q||"",sort:t.params.order||"start_date:desc",currentPage:parseInt(t.params.page)||1,perPage:parseInt(t.params.per_page)||20,items:[],links:[],init:function(){var t=this;this.loadItems(!1),setTimeout((function(){(0,W.Z)(t.$refs.startDateRef,{locale:G.Ukrainian,allowInput:!0,dateFormat:"d.m.Y",onChange:function(e){var n,r=e[0]?K()(e[0]).format("DD.MM.YYYY"):null,i=t.tour.duration+t.tour.nights;n=t.tour.duration>t.tour.nights?Math.floor(i/2):Math.ceil(i/2);var a=e[0]?K()(e[0]).add(n,"days").format("DD.MM.YYYY"):null;t.scheduleData=J(J({},t.scheduleData),{},{start_date:r,end_date:a})}})}),100)},setPage:function(t){var e=g(t);this.currentPage=e.page||1,this.loadItems(!0)},setSorting:function(t){this.sort=t,this.loadItems(!0)},loadItems:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];z({url:"",params:{page:this.currentPage,per_page:this.perPage,order:this.sort},updateUrl:e,defaultParams:{page:1,per_page:20,order:"start_date:desc"},onSuccess:function(e){t.items=e.data,t.links=e.links}})},get scheduleModal(){return bootstrap.Modal.getOrCreateInstance(document.getElementById("editScheduleModal"))},editSchedule:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e={price:this.tour.price,commission:this.tour.commission,accomm_price:this.tour.accomm_price};this.scheduleData=J(J(J({},et),e),t),this.scheduleModal.show()},cancelSchedule:function(){this.scheduleModal.hide()},saveSchedule:function(){var t=J({},this.scheduleData);t.id>0?this.updateSchedule({id:t.id},t):this.createSchedule(t)},createSchedule:function(t){var e=this;!function(t){var e=t.url,n=t.params,r=void 0===n?{}:n,i=t.onSuccess,a=void 0===i?null:i,o=t.onError,s=void 0===o?null:o;p().post(e,r).then((function(t){var e=t.data;a&&a(e)})).catch((function(t){Q(t),s&&s(t)}))}({url:"/admin/tour/".concat(this.tour.id,"/schedule"),params:t,onSuccess:function(t){O.A.success(t.message),e.scheduleModal.hide(),e.loadItems()}})},updateSchedule:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};N({url:"/admin/tour/".concat(this.tour.id,"/schedule/").concat(t.id),params:n,onSuccess:function(t){O.A.success(t.message),e.scheduleModal.hide(),e.loadItems()}})},deleteSchedule:function(t){var e=this;H("/admin/tour/".concat(this.tour.id,"/schedule/").concat(t.id),(function(){e.loadItems()}))}}},rt=function(t){return{locales:t.locales,types:t.types||[],finances:t.finances||[],model:t.model,includeOptions:t.includeOptions,excludeOptions:t.excludeOptions,finance:t.finance||null,financeOptions:[],init:function(){this.model&&this.model.type_id>0&&(this.financeOptions=1===this.model.type_id?this.includeOptions:this.excludeOptions)},onTypeChange:function(){this.model&&this.model.type_id>0?this.financeOptions=1===this.model.type_id?this.includeOptions:this.excludeOptions:this.financeOptions=[]},onFinanceChange:function(){var t=this;this.model&&this.model.finance_id>0?this.finance=this.finances.find((function(e){return e.id===t.model.finance_id})):this.finance=null}}},it=function(t){return{locale:document.documentElement.lang||"uk",locales:t.locales,trans_expanded:!1,landings:t.landings||[],model:t.model,landing:t.landing||null,init:function(){var t=this;this.$watch("model.landing_id",(function(e){return t.onLandingChange(e)}))},onTypeChange:function(){setTimeout((function(){window.LocationGroup(document.querySelector(".location-group"))}),1e3),this.trans_expanded=this.model.type<=1},onLandingChange:function(t){this.landing=this.landings.find((function(e){return e.id==t}))},get landingOptions(){var t=this;return this.landings.map((function(e){return{value:e.id,text:e.title[t.locale]||e.title}}))}}},at=function(t){return{trans_expanded:!1,trans_locale:"uk",menus:t,init:function(){}}};var ot=n(4399);function st(t){return function(t){if(Array.isArray(t))return ct(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return ct(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ct(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ct(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}const ut=function(t){return{items:t.items,childDrag:!1,dragging:null,dropping:null,onDrop:function(t){if(!this.childDrag&&null!==this.dragging&&null!==this.dropping){this.dragging<this.dropping?this.items=[].concat(st(this.items.slice(0,this.dragging)),st(this.items.slice(this.dragging+1,this.dropping+1)),[this.items[this.dragging]],st(this.items.slice(this.dropping+1))):this.items=[].concat(st(this.items.slice(0,this.dropping)),[this.items[this.dragging]],st(this.items.slice(this.dropping,this.dragging)),st(this.items.slice(this.dragging+1)));var e=this.items.map((function(t,e){return{id:t.id,position:e}}));axios.post("/admin/site-menu/sort",{sortData:e}).then((function(t){var e=t.data;console.log(e.result)})).catch((function(t){console.log(t),O.A.error(t.message)}))}this.dropping=null},onDragEnter:function(t){this.childDrag||t!==this.dragging&&(this.dropping=t)},onDragLeave:function(t){this.childDrag||this.dropping===t&&(this.dropping=null)},onDragStart:function(t){this.childDrag||(this.dragging=t)},onDragEnd:function(){this.childDrag||(this.dragging=null)},deleteItem:function(t){var e=this;ot.Z.fire({text:"Ви впевнені?",icon:"warning",showCancelButton:!0,confirmButtonText:"Так",cancelButtonText:"Відмінити"}).then((function(n){n.value&&axios.delete("/admin/site-menu/".concat(t,"/delete")).then((function(n){var r=n.data;"success"===r.result&&(O.A.success(r.message),e.items=e.items.filter((function(e){return e.id!==t})))})).catch((function(t){console.log(t),O.A.error(t.message)}))}))},changeStatus:function(t){axios.patch("/admin/site-menu/".concat(t.id,"/status")).then((function(t){var e=t.data;"success"===e.result&&O.A.success(e.message)})).catch((function(t){console.log(t),O.A.error(t.message)}))}}};function dt(t){return function(t){if(Array.isArray(t))return lt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return lt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return lt(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}const ht=function(t){return{children:t.children,opened:!1,chDragging:null,chDropping:null,init:function(){},toggle:function(){this.opened=!this.opened},onDropCh:function(){if(null!==this.chDragging&&null!==this.chDropping){this.chDragging<this.chDropping?this.children=[].concat(dt(this.children.slice(0,this.chDragging)),dt(this.children.slice(this.chDragging+1,this.chDropping+1)),[this.children[this.chDragging]],dt(this.children.slice(this.chDropping+1))):this.children=[].concat(dt(this.children.slice(0,this.chDropping)),[this.children[this.chDragging]],dt(this.children.slice(this.chDropping,this.chDragging)),dt(this.children.slice(this.chDragging+1)));var t=this.children.map((function(t,e){return{id:t.id,position:e}}));axios.post("/admin/site-menu/sort",{sortData:t}).then((function(t){var e=t.data;console.log(e.result)})).catch((function(t){console.log(t),O.A.error(t.message)}))}this.chDropping=null},onDragEnterCh:function(t){t!==this.chDragging&&(this.chDropping=t)},onDragLeaveCh:function(t){this.chDropping===t&&(this.chDropping=null)},onDragStartCh:function(t){this.chDragging=t},onDragEndCh:function(){this.chDragging=null},deleteChildren:function(t){var e=this;ot.Z.fire({text:"Ви впевнені?",icon:"warning",showCancelButton:!0,confirmButtonText:"Так",cancelButtonText:"Відмінити"}).then((function(n){n.value&&axios.delete("/admin/site-menu/".concat(t,"/delete")).then((function(n){var r=n.data;"success"===r.result&&(O.A.success(r.message),e.children=e.children.filter((function(e){return e.id!==t})))})).catch((function(t){console.log(t),O.A.error(t.message)}))}))}}};var mt=null;const pt=function(t){return{links:[],clients:[],edit:!1,create:!1,loader:!1,search:t.params.q||"",sort:t.params.order||"bitrix_id:asc",current_page:parseInt(t.params.page)||1,selectedClient:null,init:function(){var t=this;this.loadClients(!1),this.$watch("search",(function(){t.current_page=1,t.loadClients(!0)}))},loadClients:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];mt&&mt.cancel(),mt=p().CancelToken.source(),this.loader=!0;var n={q:this.search,order:this.sort,page:this.current_page};if(e){var r=y(n,{q:"",order:"bitrix_id:asc",page:1});j(document.location.pathname,r,!1)}p().get("",{cancelToken:mt.token,params:n}).then((function(e){var n=e.data;t.clients=n.data,t.links=n.links,t.loader=!1})).catch((function(e){console.log(e),t.loader=!1}))},setPage:function(t){var e=g(t);this.current_page=e.page||1,this.loadClients(!0)},setSorting:function(t){this.sort=t,this.loadClients(!0)},cancelEdit:function(){this.edit=!1},editClient:function(t){this.selectedClient=t,this.edit=!0},createClient:function(){this.selectedClient={id:null,bitrix_id:null,first_name:"",last_name:"",email:[],phone:[]},this.create=!0},cancelCreate:function(){this.create=!1},deleteClient:function(t){var e=this;Swal.fire({text:"Ви впевнені?",icon:"warning",showCancelButton:!0,confirmButtonText:"Так",cancelButtonText:"Відмінити"}).then((function(n){n.value&&p().delete("/admin/crm/clients/".concat(t.id)).then((function(t){var n=t.data;"success"===n.result&&(O.A.success(n.message),e.loadClients(!0))})).catch((function(t){console.log(t),O.A.error(t.message)}))}))},saveClient:function(){var t=this,e={id:this.selectedClient.id,bitrix_id:this.selectedClient.bitrix_id,first_name:this.selectedClient.first_name,last_name:this.selectedClient.last_name,email:this.selectedClient.email,phone:this.selectedClient.phone};p().patch("/admin/crm/clients/".concat(e.id),e).then((function(e){var n=e.data;"success"===n.result&&(O.A.success(n.message),t.loadClients(!0),t.edit=!1)})).catch((function(t){console.log(t),O.A.error(t.message)}))},storeClient:function(){var t=this,e={id:this.selectedClient.id,bitrix_id:this.selectedClient.bitrix_id,first_name:this.selectedClient.first_name,last_name:this.selectedClient.last_name,email:this.selectedClient.email,phone:this.selectedClient.phone};p().post("/admin/crm/clients",e).then((function(e){var n=e.data;"success"===n.result&&(O.A.success(n.message),t.loadClients(!0),t.create=!1)})).catch((function(t){console.log(t),O.A.error(t.message)}))},addEmail:function(){this.selectedClient&&this.selectedClient.email.push("")},removeEmail:function(t){this.selectedClient&&this.selectedClient.email.splice(t,1)},addPhone:function(){this.selectedClient&&this.selectedClient.phone.push("")},removePhone:function(t){this.selectedClient&&this.selectedClient.phone.splice(t,1)}}};var ft=function(){var t=window.navigator.userAgent,e=t.indexOf("MSIE ");if(e>0)return parseInt(t.substring(e+5,t.indexOf(".",e)),10);if(t.indexOf("Trident/")>0){var n=t.indexOf("rv:");return parseInt(t.substring(n+3,t.indexOf(".",n)),10)}var r=t.indexOf("Edge/");return r>0&&parseInt(t.substring(r+5,t.indexOf(".",r)),10)}(),gt=(window.PointerEvent,n(8013),function(t){return(""+t).replace(/\D/g,"")}),vt=function(t){var e=gt(t).match(/^(\d{2})(\d{3})(\d{3})(\d{2})(\d{2})$/);return e?"+"+e[1]+" ("+e[2]+") "+e[3]+"-"+e[4]+"-"+e[5]:t};const yt=function(t){return{client:t,clientPhones:function(){var e=[];if(_.isArray(t.phone))e=t.phone.map((function(t){return t.replace(/[^\d]/g,"")}));else if(_.isObject(t.phone))for(var n in t.phone)e.push(t.phone[n].replace(/[^\d]/g,""));return(e=(e=e.filter((function(t,e,n){return n.indexOf(t)===e&&t.length>5}))).map((function(t){var e=t.startsWith("380")?vt(t):t.startsWith("0")?vt("38"+t):t,n=gt(e);return'<a href="tel:+'.concat(n,'">').concat(e,"</a>")}))).join("<br>")},clientEmails:function(){var e=[];if(_.isArray(t.email))e=t.email;else if(_.isObject(t.email))for(var n in t.email)e.push(t.email[n]);return(e=e.map((function(t){return'<a href="mailto:'.concat(t,'">').concat(t,"</a>")}))).join("<br>")},editUrl:function(){return"/admin/crm/clients/"+undefined.client.id}}},bt=function(t){var e=t.client,n=t.params,r=void 0===n?{}:n;return{loading:!1,client:e,links:[],items:[],current_page:parseInt(r.page)||1,sort:r.order||"created_at:desc",status:r.status||"",init:function(){this.$store.orders.current_page=parseInt(r.page)||1,this.$store.orders.sort=parseInt(r.sort)||1,this.$store.orders.status=arams.status||"",this.$store.orders.loadItems(!1)},loadItems:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.loading=!0,z({url:"",params:{status:this.status,order:this.sort,page:this.current_page},updateUrl:e,defaultParams:{status:"",order:"created_at:desc",page:1},onSuccess:function(e){t.items=e.data,t.links=e.links,t.loading=!1},onError:function(e){t.loading=!1}})},formatDate:function(t){return t?K()(t).format("DD.MM.YYYY HH:mm"):"-"},statusText:function(t){var e=this.statuses.find((function(e){return e.value===t}));return e?e.text:t},contactName:function(t){return t.last_name+" "+t.first_name},tourFirm:function(t){return t.agency_data?t.agency_data.title:"-"}}};G.Ukrainian.rangeSeparator="-";const _t=function(t){return{loading:!1,links:[],items:[],currentTab:t.params.tab||"recruited",current_page:parseInt(t.params.page)||1,sort:t.params.order||"start_date:asc",dates:t.params.dates||"",manager_id:parseInt(t.params.manager_id)||0,booked:!!t.params.booked&&!!t.params.booked,init:function(){this.loadItems(!1);(0,W.Z)(this.$refs.datesRef,{mode:"range",locale:G.Ukrainian,dateFormat:"d.m.Y",defaultDate:this.dates})},setPage:function(t){var e=g(t);this.current_page=e.page||1,this.loadItems(!0)},setTab:function(t){this.currentTab=t,this.current_page=1,this.loadItems(!0)},setSorting:function(t){this.sort=t,this.loadItems(!0)},clearDates:function(){this.dates="",this.filterChange()},filterChange:function(){this.current_page=1,this.loadItems()},loadItems:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.loading=!0,z({url:"",params:{manager_id:this.manager_id,dates:this.dates,order:this.sort,page:this.current_page,booked:this.booked?1:0,tab:this.currentTab},updateUrl:e,defaultParams:{dates:K()().format("DD.MM.YYYY"),order:"start_date:asc",page:1,manager_id:0,booked:0,tab:"recruited"},onSuccess:function(e){t.items=e.data,t.links=e.links,t.loading=!1},onError:function(e){t.loading=!1}})}}},wt=function(t){return{request:!1,schedule:t,tour:t.tour||null,manager:t.manager||null,orders:t.orders||[],init:function(){},get placesAvailable(){return Math.max(t.places-t.places_booked,0)},get scheduleUrl(){return"/admin/crm/schedules/".concat(this.schedule.id)},get tourUrl(){return this.tour?"/admin/tour/".concat(this.tour.id,"/schedule"):"#"},get tourTitle(){return this.tour?this.tour.title.uk:""},get tourManager(){return this.manager?this.manager.name:"-"},updateSchedule:function(t){var e=this;this.request=!0,axios.patch("/admin/crm/schedules/".concat(this.schedule.id),t).then((function(t){t.data;e.request=!1})).catch((function(t){e.request=!1}))}}};function jt(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function Ot(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Dt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ot(Object(n),!0).forEach((function(e){xt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ot(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function xt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var St={"1o_plus":0,"1o_sgl":0,"2o_twn":0,"2p_dbl":0,"3o_trpl":0,"2p_1o_trpl":0,"4o_qdpl":0,"2p_2p_qdpl":0,other:!1,other_text:""};const At=function(t){return{edit:!1,loader:!1,schedule:t.schedule,orders:t.orders||[],statuses:t.statuses||[],roomTypes:t.roomTypes||[],currentTab:t.params.tab||"common",sort:t.params.order||"id:asc",countOrders:t.countOrders,accommodation:Dt({},St),participants:{items:[],participant_phone:""},participantData:{first_name:"",last_name:"",middle_name:"",birthday:""},agencyData:{title:"",affiliate:"",manager_name:"",manager_email:"",manager_phone:""},selectedOrder:{id:null,status:"new",first_name:"",last_name:"",phone:"",email:""},scheduleData:Dt({},t.schedule),selectedOrders:[],init:function(){var t=this;setTimeout((function(){t.$refs.pickerInput&&(0,W.Z)(t.$refs.pickerInput,{locale:G.Ukrainian,allowInput:!0,dateFormat:"d.m.Y"}),(0,W.Z)(t.$refs.startDateRef,{locale:G.Ukrainian,allowInput:!0,dateFormat:"d.m.Y",onChange:function(e,n,r){var i=e[0]?K()(e[0]).format("DD.MM.YYYY"):null,a=e[1]?K()(e[1]).format("DD.MM.YYYY"):null;console.log(i,a),t.scheduleData=Dt(Dt({},t.scheduleData),{},{start_date:i,end_date:a})}})}),500),this.loadOrders(!1)},setTab:function(t){this.currentTab=t,this.loadOrders()},loadOrders:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.loader=!0,z({url:"",params:{tab:this.currentTab,order:this.sort},updateUrl:e,defaultParams:{tab:"common",order:"id:asc"},onSuccess:function(e){t.orders=e.orders,t.countOrders=e.countOrders,t.loader=!1},onError:function(e){Q(e),t.loader=!1}})},statusText:function(t){var e=this.statuses.find((function(e){return e.value===t}));return e?e.text:t},formatDate:function(t){return K()(t,"DD.MM.YYYY").format("DD.MM.YYYY")},roomTitle:function(t){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];t=(t||"").trim().replaceAll("-","_").replaceAll(" ","_").replaceAll("р","p").replaceAll("о","o");var n=e.find((function(e){return e.value===t}));return n?n.text:t.replaceAll("-"," ").replaceAll("_"," ")}(t,this.roomTypes)},paymentGet:function(t){return 1*(t.total_price-t.payment_fop-t.payment_tov-t.payment_office)},updateOrder:function(t,e){var n=this;N({url:"/admin/order/".concat(t),params:e,onSuccess:function(r){if(e.status)n.loadOrders(!1);else{var i=n.orders.findIndex((function(e){return e.id===t}));n.orders[i]=r.model}},onError:function(){n.loadOrders(!1)}})},get scheduleModal(){return bootstrap.Modal.getOrCreateInstance(document.getElementById("editScheduleModal"))},editSchedule:function(){this.scheduleData=Dt({},this.schedule),this.scheduleModal.show()},cancelSchedule:function(){this.scheduleModal.hide()},saveSchedule:function(){var t=this,e=Dt({},this.scheduleData);this.updateSchedule(e,(function(e){t.scheduleModal.hide()}))},updateSchedule:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.loader=!0,N({url:"/admin/crm/schedules/".concat(this.schedule.id),params:e,onSuccess:function(e){n&&n(e),t.schedule=e.schedule,O.A.success(e.message),t.loader=!1},onError:function(){t.loader=!1}})},togglePublished:function(){var t=this;this.updateSchedule({published:this.schedule.published},(function(){t.schedule.published?O.A.success("Виїзд опубліковано"):O.A.success("Виїзд скасовано")}))},setSorting:function(t){this.sort=t,this.loadOrders(!0)},editOrder:function(t){this.selectedOrder={id:t.id,first_name:t.first_name||"",last_name:t.last_name||"",middle_name:t.middle_name||"",birthday:t.birthday||"",phone:t.phone||"",email:t.email||"",viber:t.viber||""};var e={};if(t.accommodation)for(var n in t.accommodation){var r=t.accommodation[n];e[n.trim().replaceAll("-","_").replaceAll(" ","_")]="other"===n?!!r:r}this.accommodation=Dt(Dt({},St),e),this.agencyData={title:t.agency_data&&t.agency_data.title?t.agency_data.title:"",affiliate:t.agency_data&&t.agency_data.affiliate?t.agency_data.affiliate:"",manager_name:t.agency_data&&t.agency_data.manager_name?t.agency_data.manager_name:"",manager_email:t.agency_data&&t.agency_data.manager_email?t.agency_data.manager_email:"",manager_phone:t.agency_data&&t.agency_data.manager_phone?t.agency_data.manager_phone:""},this.edit=!0},cancelEdit:function(){this.edit=!1},saveOrder:function(){this.edit=!1;var t=Dt(Dt({},this.selectedOrder),{},{accommodation:Dt({},this.accommodation),agency_data:Dt({},this.agencyData)});this.updateOrder(this.selectedOrder.id,t)},get participantsModal(){return bootstrap.Modal.getOrCreateInstance(document.getElementById("editParticipantsModal"))},get isCustomerParticipant(){return this.participants&&!!this.participants.customer},set isCustomerParticipant(t){this.participants?this.participants.customer=t:this.participants={items:[],participant_phone:"",customer:t}},participantNames:function(t){var e=[];return t.participants&&t.participants.items&&t.participants.items.forEach((function(t){var n="".concat(t.last_name||""," ").concat(t.first_name||""," ").concat(t.middle_name||"").trim();e.push("<div>".concat(n,"</div>"))})),e.join("")},participantDates:function(t){var e=this,n=[];return t.participants&&t.participants.items&&t.participants.items.forEach((function(t){var r="&nbsp;";t.birthday&&(r=e.formatDate(t.birthday)),n.push("<div>".concat(r,"</div>"))})),n.join("")},editParticipants:function(t){this.selectedOrder={id:t.id,first_name:t.first_name||"",last_name:t.last_name||"",middle_name:t.middle_name||"",birthday:t.birthday||"",places:t.places,children:!!t.children,without_place:!!t.without_place,without_place_count:t.without_place_count?t.without_place_count:0,children_young:t.children?t.children_young:0,children_older:t.children?t.children_older:0},this.participants={items:t.participants&&t.participants.items?t.participants.items.map((function(t){return Object.assign({first_name:"",last_name:"",middle_name:"",birthday:""},t)})):[],participant_phone:t.participants&&t.participants.participant_phone?t.participants.participant_phone:"",customer:t.participants&&t.participants.customer},this.participantsModal.show()},cancelParticipants:function(){this.participantsModal.hide()},saveParticipants:function(){this.selectedOrder.id>0&&this.updateOrder(this.selectedOrder.id,Dt(Dt({},this.selectedOrder),{},{participants:Dt({},this.participants)})),this.participantsModal.hide()},removeParticipant:function(t){this.participants.items.splice(t,1)},addParticipant:function(){this.participants||(this.participants={items:[],participant_phone:""}),this.participantData.first_name&&(this.participants.items.push(Dt({},this.participantData)),this.participantData={first_name:"",last_name:"",middle_name:"",birthday:""})},get statusModal(){return bootstrap.Modal.getOrCreateInstance(document.getElementById("editStatusModal"))},editStatus:function(t){this.selectedOrder={id:t.id,status:t.status,total_places:t.total_places},this.statusModal.show()},cancelStatus:function(){this.statusModal.hide()},saveStatus:function(){this.updateOrder(this.selectedOrder.id,{status:this.selectedOrder.status}),this.statusModal.hide(),this.loadOrders(!1)},get totalPlaces(){var t=0;return this.orders.forEach((function(e){return t+=e.total_places})),t},get totalSum(){var t=0;return this.orders.forEach((function(e){return t+=1*e.total_price})),t},get totalSumFop(){var t=0;return this.orders.forEach((function(e){return t+=1*e.payment_fop})),t},get totalSumTov(){var t=0;return this.orders.forEach((function(e){return t+=1*e.payment_tov})),t},get totalSumOffice(){var t=0;return this.orders.forEach((function(e){return t+=1*e.payment_office})),t},get totalSumGet(){var t=this,e=0;return this.orders.forEach((function(n){return e+=t.paymentGet(n)})),e},clearPhone:function(t){return"+"+gt(t)},get disabledBookedStatus(){return"reserve"===this.currentTab&&this.selectedOrder.total_places>this.schedule.places_available},selectAllOrders:function(t){this.selectedOrders=t.target.checked?this.orders.map((function(t){return t.id})):[]},exportOrders:function(t){var e=t.target.href;this.selectedOrders.length&&(e+="&orders=["+this.selectedOrders.join(",")+"]"),window.open(e)},uploadInfoList:function(t){var e,n=this;return(e=o().mark((function t(){var e,r,i,a;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=new FormData,r=document.getElementsByName("info_sheet_upload")[0],i=r.files[0]||null,e.append("info_sheet",i),t.next=6,p().post("/admin/crm/schedules/".concat(n.schedule.id,"/info_sheet"),e,{headers:{"Content-Type":"multipart/form-data"}});case 6:(a=t.sent).data&&("success"===a.data.result?O.A.success(a.data.message):O.A.error(a.data.message));case 8:case"end":return t.stop()}}),t)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(t){jt(a,r,i,o,s,"next",t)}function s(t){jt(a,r,i,o,s,"throw",t)}o(void 0)}))})()}}},kt=function(t){var e=t.order,n=t.statuses,r=t.schedules,i=t.redirect;return{redirect:void 0!==i&&i,editor:null,statuses:n||[],order:e,data:{first_name:e.first_name||"",last_name:e.last_name||"",phone:e.phone||"",email:e.email||"",viber:e.viber||"",company:e.company||"",tour_id:e.tour_id||null,schedule_id:e.schedule_id||null,places:e.places||null,children:e.children||!1,children_older:e.children_older||0,children_young:e.children_young||0},status:e.status||"new",notifySend:!1,notifyEmail:e.email,notifyMessage:"",tour:e.tour||null,schedule:e.schedule||null,schedules:r||[],init:function(){var t=this;setTimeout((function(){var e=document.getElementById("tourSelectBox");jQuery(e).select2({theme:"bootstrap-5",ajax:{url:"/api/tours/select-box",dataType:"json",data:function(t){return{q:t.term,page:t.page||1,limit:20}}}}),jQuery(e).on("select2:select",(function(e){t.data.tour_id=e.params.data.id,t.data.schedule_id=null,t.loadSchedules()})),t.$watch("notifyEmail",(function(e){e?t.editor=M().init({selector:"#notify-message",language:"uk",toolbar:"undo redo | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent emoticons ",menubar:"",setup:function(e){e.on("Input",(function(n){t.notifyMessage=e.getContent()})),e.on("Change",(function(n){t.notifyMessage=e.getContent()}))}}):t.editor&&t.editor.destroy()}))}),200)},loadSchedules:function(){var t=this;p().get("/api/tours/".concat(this.data.tour_id,"/all-schedules")).then((function(e){t.schedules=e.data}))},get clientName(){return this.data.last_name+" "+this.data.first_name},get statusText(){var t=this,e=this.statuses.find((function(e){return e.value===t.status}));return e?e.text:"-"},get totalPlaces(){var t=this.data.places;return this.data.children&&(t+=this.data.children_young,t+=this.data.children_older),t},resetData:function(){this.data={first_name:this.order.first_name||"",last_name:this.order.last_name||"",phone:this.order.phone||"",email:this.order.email||"",viber:this.order.viber||"",company:this.order.company||"",tour_id:this.order.tour_id||null,schedule_id:this.order.schedule_id||null,places:this.order.places||null,children:this.order.children||!1,children_older:this.order.children_older||0,children_young:this.order.children_young||0},this.status=this.order.status},updateOrder:function(){var t=this;p().patch("/admin/order/".concat(this.order.id),this.data).then((function(e){var n=e.data,r=t.schedule?t.schedule.id:0,i=n.model.schedule?n.model.schedule.id:0;t.order=n.model,t.status=n.model.status,t.tour=n.model.tour,t.schedule=n.model.schedule,t.redirect&&i>0&&r!==i?(O.A.success(n.message+". Перенаправлення..."),document.location.href="/admin/crm/schedules/".concat(i,"/order/").concat(t.order.id)):O.A.success(n.message)})).catch((function(t){console.log(t)}))},updateOrderStatus:function(){var t=this;p().patch("/admin/order/".concat(this.order.id,"/update-status"),{status:this.status,notifySend:this.notifySend,notifyEmail:this.notifyEmail,notifyMessage:this.notifyMessage}).then((function(e){var n=e.data;O.A.success(n.message),t.status=n.model.status})).catch((function(t){console.log(t)}))}}};const Ct=function(t){return{order:t.order||{},attributes:t.attributes||[],attributeIds:[],editableIds:[],customer:{first_name:t.order.first_name||"",last_name:t.order.last_name||"",middle_name:t.order.middle_name||"",birthday:t.order.birthday||"",phone:t.order.phone||"",email:t.order.email||"",viber:t.order.viber||"",company:t.order.company||""},init:function(){},isEditable:function(t){return this.editableIds.indexOf(t)>-1},editAttribute:function(t){this.isEditable(t)||(this.editableIds.push(t),this.customer[t]=this.order[t]||"")},saveAttribute:function(t){var e=this;this.updateAttribute(t,this.customer[t]).then((function(){e.isEditable(t)&&e.editableIds.splice(e.editableIds.indexOf(t))}))},cancelAttribute:function(t){this.isEditable(t)&&this.editableIds.splice(this.editableIds.indexOf(t)),this.customer[t]=this.order[t]},updateAttribute:function(t,e){var n=this;return p().patch("/admin/order/".concat(this.order.id),function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}({},t,e)).then((function(t){var e=t.data;n.order=e.model,O.A.success(e.message)})).catch((function(t){console.log(t)}))}}};function It(t){return function(t){if(Array.isArray(t))return Pt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return Pt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pt(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}const Et=function(t){return{order:t.order||{},attributes:t.attributes||[],attributeIds:[],editableIds:[],schedule:t.order,init:function(){this.loadSchedules()},getValue:function(t){var e,n=this;return t.value||((null===(e=t.options)||void 0===e?void 0:e.find((function(e){return e.value===n.schedule[t.key]})))||{text:this.schedule[t.key]}).text},initTourSelect:function(){var t=this;setTimeout((function(){var e=document.getElementsByName("tour_id");jQuery(e).select2({theme:"bootstrap-5",ajax:{url:"/api/tours/select-box",dataType:"json",data:function(t){return{q:t.term,page:t.page||1,limit:20}}}}),jQuery(e).on("select2:select",(function(e){e.params.data.id!==t.order.schedule_id&&(t.schedule.schedule_id=0),t.schedule.tour_id=e.params.data.id;var n=t.attributes.find((function(t){return"tour_id"===t.key}));n.options=[{value:e.params.data.id,text:e.params.data.text}];var r=n.options.find((function(e){return e.value===t.schedule.tour_id}))||{text:t.schedule.tour_id};n.value=r.text,t.loadSchedules()}))}),200)},isEditable:function(t){return this.editableIds.indexOf(t)>-1},editAttribute:function(t){this.isEditable(t)||(this.editableIds.push(t),this.schedule[t]=this.order[t]||"","tour_id"===t&&this.initTourSelect())},saveAttribute:function(t){var e=this;this.updateAttribute(t,this.schedule[t]).then((function(){e.isEditable(t)&&e.editableIds.splice(e.editableIds.indexOf(t))}))},cancelAttribute:function(t){this.isEditable(t)&&this.editableIds.splice(this.editableIds.indexOf(t)),this.schedule[t]=this.order[t]},loadSchedules:function(){var t=this;this.schedule.tour_id&&p().get("/api/tours/".concat(this.schedule.tour_id,"/all-schedules")).then((function(e){var n=t.attributes.find((function(t){return"schedule_id"===t.key})),r=e.data.map((function(t){return{value:t.id,text:t.start_title}})),i=[];i=0===t.schedule.schedule_id?It(r):[].concat(It(n.options),It(r)),n.options=It(new Map(i.map((function(t){return[t.value,t]}))).values());var a=n.options.find((function(e){return e.value===t.schedule.schedule_id}))||(0===t.schedule.schedule_id?r.shift():{text:t.schedule.schedule_id});t.schedule.schedule_id=a.value||a.text,n.value=a.text}))},updateAttribute:function(t,e){var n=this;return p().patch("/admin/order/".concat(this.order.id),this.schedule).then((function(t){var e=t.data;n.order=e.model,O.A.success(e.message)})).catch((function(t){console.log(t)}))}}};var Mt={first_name:"",last_name:"",middle_name:"",birthday:""};const Tt=function(t){return{order:t,editIndex:null,participants:t.participants&&t.participants.items||[],participantPhone:t.participants&&t.participants.participant_phone||"",data:{first_name:"",last_name:"",middle_name:"",birthday:""},get modal(){return bootstrap.Modal.getOrCreateInstance(document.getElementById("edit-participant-modal"))},participantFio:function(t){return(t.last_name+" "+t.first_name+" "+t.middle_name).replaceAll("null","").trim()},editParticipant:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null!==t){var e=this.participants[t];this.data={first_name:e.first_name||"",last_name:e.last_name||"",middle_name:e.middle_name||"",birthday:e.birthday||""},console.log(e,this.data)}else this.data=Object.assign({},Mt);this.editIndex=t,this.modal.show()},cancelEdit:function(){this.modal.hide(),this.editIndex=null,this.data=Object.assign({},Mt)},saveParticipant:function(){null!==this.editIndex?this.participants[this.editIndex]={first_name:this.data.first_name,last_name:this.data.last_name,middle_name:this.data.middle_name,birthday:this.data.birthday}:this.participants.push({first_name:this.data.first_name,last_name:this.data.last_name,middle_name:this.data.middle_name,birthday:this.data.birthday}),this.updateOrder(),this.modal.hide()},deleteParticipant:function(t){this.participants.splice(t,1),this.updateOrder()},updateOrder:function(){var t=this;this.order.id>0&&p().patch("/admin/order/".concat(this.order.id),{participants:{items:this.participants,participant_phone:this.participantPhone}}).then((function(e){var n=e.data;t.order=n.model,t.participants=n.model.participants.items,t.participantPhone=n.model.participants.participant_phone,O.A.success(n.message)})).catch((function(t){console.log(t)}))}}};var qt={title:"",affiliate:"",manager_name:"",manager_phone:"",manager_email:""};const Lt=function(t){return{order:t,agency:Object.assign({},qt,t.agency_data||{}),get modal(){return bootstrap.Modal.getOrCreateInstance(document.getElementById("edit-agency-modal"))},edit:function(){this.agency=Object.assign({},qt,this.order.agency_data||{}),this.modal.show()},cancel:function(){this.modal.hide(),this.agency=Object.assign({},qt,this.order.agency_data||{})},save:function(){var t=this;p().patch("/admin/order/".concat(this.order.id),{agency_data:{title:this.agency.title,affiliate:this.agency.affiliate,manager_name:this.agency.manager_name,manager_phone:this.agency.manager_phone,manager_email:this.agency.manager_email}}).then((function(e){var n=e.data;t.order=n.model,t.agency=Object.assign({},qt,n.model.agency_data||{}),t.modal.hide(),O.A.success(n.message)})).catch((function(t){console.log(t)}))}}};function Ut(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function $t(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ut(Object(n),!0).forEach((function(e){Bt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ut(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Bt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ft(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==n)return;var r,i,a=[],o=!0,s=!1;try{for(n=n.call(t);!(o=(r=n.next()).done)&&(a.push(r.value),!e||a.length!==e);o=!0);}catch(t){s=!0,i=t}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Yt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Yt(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Rt(t){return(Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var Qt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Swal.fire({text:e.text||"Ви впевнені?",icon:e.icon||"warning",showCancelButton:e.showCancelButton||!0,confirmButtonText:e.confirmButtonText||"Так",cancelButtonText:e.cancelButtonText||"Відмінити"}).then((function(e){e.value?"object"===Rt(t)&&"function"==typeof t.onTrue?t.onTrue():t():"object"===Rt(t)&&"function"==typeof t.onFalse&&t.onFalse()}))};function Zt(t){return function(t){if(Array.isArray(t))return zt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return zt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zt(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Nt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ht(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Nt(Object(n),!0).forEach((function(e){Wt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Nt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Wt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Array.prototype.toggle=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){return t},n=this.findIndex((function(n){return e(n)===e(t)}));return-1===n?this.push(t):this.splice(n,1),this},Array.prototype.toObject=function(){return Object.entries(this).reduce((function(t,e){var n=Ft(e,2),r=n[0],i=n[1];return $t($t({},t),{},Bt({},i,r))}),{})},String.prototype.ucFirst=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.ucWords=function(){return this.split(" ").map((function(t){return t.ucFirst()})).join(" ")};var Gt={id:0,title:"",value:0,places:0};const Vt=function(t){var e;return{order:t.order,tour:null!==(e=t.tour)&&void 0!==e?e:null,schedules:[],orderPrice:t.order.price||0,editSumMode:!1,init:function(){this.order.tour_id>0&&this.loadSchedules(!1)},loadSchedules:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&(this.order.schedule_id=null),p().get("/api/tours/".concat(this.order.tour_id,"/all-schedules")).then((function(e){t.schedules=e.data}))},editSum:function(){this.orderPrice=this.order.price,this.editSumMode=!0},saveSum:function(){this.editSumMode=!1,this.updateOrder({price:this.orderPrice})},cancelSum:function(){this.editSumMode=!1,this.orderPrice=this.order.price},orderCommission:t.order.commission||0,editComMode:!1,editCom:function(){this.orderCommission=this.order.commission,this.editComMode=!0},saveCom:function(){this.editComMode=!1,this.updateOrder({commission:this.orderCommission||0})},cancelCom:function(){this.editComMode=!1,this.orderCommission=this.order.commission},orderAccomm:t.order.accomm_price||0,editAccommMode:!1,editAccomm:function(){this.orderAccomm=this.order.accomm_price,this.editAccommMode=!0},saveAccomm:function(){this.editAccommMode=!1,this.updateOrder({accomm_price:this.orderAccomm||0})},cancelAccomm:function(){this.editAccommMode=!1,this.orderAccomm=this.order.accomm_price},tourDiscounts:t.discounts||[],discounts:t.order.discounts||[],discountIdx:null,discountData:Ht({},Gt),get discountModal(){return bootstrap.Modal.getOrCreateInstance(document.getElementById("edit-discount-modal"))},get totalDiscount(){var t=0;return this.discounts.forEach((function(e){t+=e.value*(e.places||1)})),t},editDiscount:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.discountIdx=t,this.discountData=null!==t?{id:this.discounts[t].id||0,title:this.discounts[t].title,value:this.discounts[t].value,places:this.discounts[t].places||1}:Ht({},Gt),this.discountModal.show()},cancelDiscount:function(){this.discountModal.hide(),this.discountIdx=null,this.discountData=Ht({},Gt)},discountChanged:function(){var t=this.discountData.id||0,e=this.tourDiscounts.find((function(e){return e.id===t})),n=0;e&&(n="percent"===e.type||1===e.type?this.placePrice/100*e.price:e.price);var r={title:e?e.admin_title||e.title.uk||e.title:"",value:n};this.discountData=Ht(Ht({},this.discountData),r),console.log(this.discountData)},saveDiscount:function(){var t=this.discountData.id||0,e=this.tourDiscounts.find((function(e){return e.id===t})),n=e?e.admin_title||e.title.uk||e.title:this.discountData.title,r=this.discountData.places||1,i=this.discountData.value;e&&(i="percent"===e.type||1===e.type?this.placePrice/100*e.price:e.price);var a={id:t,title:n,value:i,places:r};null!==this.discountIdx?this.discounts[this.discountIdx]=a:this.discounts.push(a),this.updateOrder({discount:this.totalDiscount,discounts:Zt(this.discounts)}),this.discountModal.hide()},deleteDiscount:function(t){var e=this;Qt((function(){e.discounts.splice(t,1),e.updateOrder({discount:e.totalDiscount,discounts:Zt(e.discounts)})}))},get selectedSchedule(){var t=this;return this.order.schedule_id>0?this.schedules.find((function(e){return e.id===t.order.schedule_id})):null},get placePrice(){return this.selectedSchedule?this.selectedSchedule.price:this.tour?this.tour.price:0},payments:t.order.payment_data||[],paymentIdx:null,paymentData:{sum:null,type:"",recipient:"",comment:""},get paymentModal(){return bootstrap.Modal.getOrCreateInstance(document.getElementById("edit-payment-modal"))},editPayment:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.paymentIdx=t,this.paymentData=null!==t?{sum:this.payments[t].sum||null,date:this.payments[t].date||"",type:this.payments[t].type||"",recipient:this.payments[t].recipient||"",comment:this.payments[t].comment||""}:{sum:null,date:"",type:"",recipient:"",comment:""},this.paymentModal.show()},cancelPayment:function(){this.paymentModal.hide(),this.paymentIdx=null,this.paymentData={sum:null,type:"",date:"",recipient:"",comment:""}},savePayment:function(){var t={sum:this.paymentData.sum||null,date:this.paymentData.date||"",type:this.paymentData.type||"",recipient:this.paymentData.recipient||"",comment:this.paymentData.comment||""};null!==this.paymentIdx?this.payments[this.paymentIdx]=t:this.payments.push(t),this.updateOrder({payment_data:Zt(this.payments)}),this.paymentModal.hide()},deletePayment:function(t){var e=this;Qt((function(){e.payments.splice(t,1),e.updateOrder({payment_data:Zt(e.payments)})}))},get totalPayed(){var t=0;return this.payments.forEach((function(e){t+=e.sum})),t},get totalPrice(){return this.orderPrice-this.orderCommission-this.totalDiscount+this.orderAccomm},get pickUpPayment(){return this.totalPrice-this.totalPayed},updateOrder:function(t){var e=this;p().patch("/admin/order/".concat(this.order.id),t).then((function(t){var n=t.data;e.order=n.model,e.payments=n.model.payment_data||[],e.discounts=n.model.discounts||[],e.orderPrice=n.model.price||0,e.orderCommission=n.model.commission||0,e.orderAccomm=n.model.accomm_price||0,O.A.success(n.message)})).catch((function(t){console.log(t)}))}}},Kt=function(t){return{order:t,comment:t.comment,admin_comment:t.admin_comment,utm_data:Object.assign({customer_source:"",customer_device:""},t.utm_data),get modal(){return bootstrap.Modal.getOrCreateInstance(document.getElementById("edit-other-modal"))},edit:function(){this.modal.show()},cancel:function(){this.modal.hide(),this.comment=this.order.comment,this.admin_comment=this.order.admin_comment,this.utm_data=Object.assign({customer_source:"",customer_device:""},this.order.utm_data)},save:function(){var t=this,e={comment:this.comment,admin_comment:this.admin_comment,utm_data:{customer_source:this.utm_data.customer_source,customer_device:this.utm_data.customer_device}};p().patch("/admin/order/".concat(this.order.id),e).then((function(e){var n=e.data;t.order=n.model,t.comment=n.model.comment||"",t.admin_comment=n.model.admin_comment||"",t.utm_data=Object.assign({customer_source:"",customer_device:""},n.model.utm_data),O.A.success(n.message)})).catch((function(t){console.log(t)})),this.modal.hide()}}};var Xt=null;G.Ukrainian.rangeSeparator="-";const Jt=function(t){return{loading:!1,links:[],items:[],statuses:t.statuses||[],current_page:parseInt(t.params.page)||1,sort:t.params.order||"created_at:desc",dates:t.params.dates||"",manager_id:parseInt(t.params.manager_id)||0,tour_id:parseInt(t.params.tour_id)||0,status:t.params.status||"",init:function(){if(this.loadItems(!1),this.$refs.datesRef)(0,W.Z)(this.$refs.datesRef,{mode:"range",locale:G.Ukrainian,dateFormat:"d.m.Y",defaultDate:this.dates})},clearDates:function(){this.dates="",this.filterChange()},setPage:function(t){var e=g(t);this.current_page=e.page||1,this.loadItems(!0)},setSorting:function(t){this.sort=t,this.loadItems(!0)},filterChange:function(){this.current_page=1,this.loadItems()},get filterData(){return{manager_id:this.manager_id,tour_id:this.tour_id,dates:this.dates,order:this.sort,page:this.current_page,status:this.status}},get defaultFilter(){return{dates:"",order:"created_at:desc",page:1,manager_id:0,tour_id:0,status:""}},loadItems:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];Xt&&Xt.cancel(),Xt=p().CancelToken.source(),this.loading=!0;var n=this.filterData;if(e){var r=y(n,this.defaultFilter);j(document.location.pathname,r,!1)}p().get("",{cancelToken:Xt.token,params:n}).then((function(e){var n=e.data;t.items=n.data,t.links=n.links,t.loading=!1})).catch((function(e){console.log(e),t.loading=!1}))},formatDate:function(t){return t?K()(t).format("DD.MM.YYYY HH:mm"):"-"},statusText:function(t){var e=this.statuses.find((function(e){return e.value===t}));return e?e.text:t},contactName:function(t){return t.last_name+" "+t.first_name},tourFirm:function(t){return t.agency_data?t.agency_data.title:"-"}}},te=function(t){var e=t.checkValidity();e||t.querySelectorAll(":invalid").forEach((function(t){if(!t.validity.valid){e=!1;var n="",r=t.closest(".form-group");if(r){var i=r.querySelector(".col-form-label");i||(i=r.querySelector("label")),i&&(n=i.innerText.replace("*","").trim())}n||(n=t.name),toast.error('Поле "<b>'+n+'</b>" має не вірне значення')}}));return e};function ee(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function ne(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){ee(a,r,i,o,s,"next",t)}function s(t){ee(a,r,i,o,s,"throw",t)}o(void 0)}))}}function re(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ie(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?re(Object(n),!0).forEach((function(e){ae(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):re(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ae(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var oe={id:0,title:"",value:0,places:0};const se=function(t){var e,n,r,i,a,s,c;return{order:ie(ie({},t.order),{},{participants:{items:(null===(e=t.order)||void 0===e||null===(n=e.participants)||void 0===n?void 0:n.items)||[],participant_phone:(null===(r=t.order)||void 0===r||null===(i=r.participants)||void 0===i?void 0:i.participant_phone)||"",customer:(null===(a=t.order)||void 0===a||null===(s=a.participants)||void 0===s?void 0:s.customer)||!1}}),tour:null!==(c=t.tour)&&void 0!==c?c:null,formChanged:!1,roomTypes:t.roomTypes||[],statuses:t.statuses,schedules:[],participantData:{first_name:"",last_name:"",middle_name:"",birthday:""},discountIdx:null,discountData:ie({},oe),tourDiscounts:t.availableDiscounts||[],fillForm:function(){var t=this;this.order.first_name="Test",this.order.last_name="Test",this.order.middle_name="Test",this.order.phone="+38 (333) 333-33-33";var e=document.getElementById("tourSelectBox");$(e).select2("open"),setTimeout((function(){$("#select2-tourSelectBox-results > *").first().mouseup(),setTimeout((function(){t.order.schedule_id=t.schedules[0].id,t.calcSum()}),500)}),500),this.order.places=1,this.isCustomerParticipant=!0},init:function(){var t=this;this.order.status||(this.order.status="booked"),this.order.tour_id>0&&this.loadSchedules(!1),this.$watch("participantData",(function(e){e.first_name&&(t.participantData.first_name=e.first_name.ucWords()),e.last_name&&(t.participantData.last_name=e.last_name.ucWords()),e.middle_name&&(t.participantData.middle_name=e.middle_name.ucWords())})),this.$watch("order",(function(e){for(var n in t.formChanged=!0,e.first_name&&(t.order.first_name=e.first_name.ucWords()),e.last_name&&(t.order.last_name=e.last_name.ucWords()),e.middle_name&&(t.order.middle_name=e.middle_name.ucWords()),e.participants||(e.participants={items:[],participant_phone:"",customer:!1}),e.participants.items)e.participants.items[n].first_name&&(t.order.participants.items[n].first_name=e.participants.items[n].first_name.ucWords()),e.participants.items[n].last_name&&(t.order.participants.items[n].last_name=e.participants.items[n].last_name.ucWords()),e.participants.items[n].middle_name&&(t.order.participants.items[n].middle_name=e.participants.items[n].middle_name.ucWords());e.is_customer=!e.is_tour_agent,e.is_tour_agent=!e.is_customer})),setTimeout((function(){var e=document.getElementById("tourSelectBox");jQuery(e).select2({theme:"bootstrap-5",ajax:{url:"/api/tours/select-box",dataType:"json",data:function(t){return{q:t.term,page:t.page||1,limit:20,relations:["discounts"],attributes:["price","commission"]}}}}),jQuery(e).on("select2:select",(function(e){t.order.tour_id=e.params.data.id,t.tour=e.params.data,t.tourDiscounts=e.params.data.discounts||[],t.order.schedule_id=null,t.loadSchedules()}))}),200),window.addEventListener("beforeunload",function(){var e=ne(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.formChanged&&(n.preventDefault(),n.returnValue="");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},loadSchedules:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e&&(this.order.schedule_id=null),p().get("/api/tours/".concat(this.order.tour_id,"/all-schedules")).then((function(e){t.schedules=e.data}))},get isCustomerParticipant(){return!!this.order.participants.customer},set isCustomerParticipant(t){t?(this.order.participants.items.unshift({first_name:this.order.first_name||"",last_name:this.order.last_name||"",middle_name:this.order.middle_name||"",birthday:this.order.birthday||""}),this.participantPhone||(this.participantPhone=this.order.phone)):this.order.participants.items.shift(),this.order.participants.customer=t},get participantPhone(){return this.order.participants&&this.order.participants.participant_phone?this.order.participants.participant_phone:""},set participantPhone(t){this.formChanged=!0,this.order.participants.participant_phone=t},get participants(){return this.order.participants?this.order.participants.items:[]},set participants(t){this.formChanged=!0,this.order.participants.items=t},addParticipant:function(){this.participantData.first_name&&(this.order.participants.items.push(ie({},this.participantData)),this.participantData={first_name:"",last_name:"",middle_name:"",birthday:""})},removeParticipant:function(t){var e=this;Qt((function(){e.order.participants.items.splice(t,1)}))},get discounts(){return this.order.discounts||[]},set discounts(t){this.formChanged=!0,this.order.discounts=t},get discountAmount(){var t=0;return this.discounts.forEach((function(e){t+=e.value*(e.places||1)||0})),t},get discountModal(){return bootstrap.Modal.getOrCreateInstance(document.getElementById("edit-discount-modal"))},editDiscount:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.discountIdx=t,this.discountData=null!==t?{id:this.discounts[t].id||0,title:this.discounts[t].title,value:this.discounts[t].value,places:this.discounts[t].places||1}:ie({},oe),this.discountModal.show()},cancelDiscount:function(){this.discountModal.hide(),this.discountIdx=null,this.discountData=ie({},oe)},discountChanged:function(){var t=this.discountData.id||0,e=this.tourDiscounts.find((function(e){return e.id===t})),n=0;e&&(n="percent"===e.type||1===e.type?this.placePrice/100*e.price:e.price);var r={title:e?e.admin_title||e.title.uk||e.title:"",value:n};this.discountData=ie(ie({},this.discountData),r)},saveDiscount:function(){var t=this.order.discounts||[],e=this.discountData.id||0,n=this.tourDiscounts.find((function(t){return t.id===e})),r=n?n.admin_title||n.title.uk||n.title:this.discountData.title,i=this.discountData.places||1,a=this.discountData.value;n&&(a="percent"===n.type||1===n.type?this.placePrice/100*n.price:n.price);var o={id:e,title:r,value:a,places:i};null!==this.discountIdx?t[this.discountIdx]=o:t.push(o),this.order.discounts=t,this.discountModal.hide()},deleteDiscount:function(t){var e=this;Qt((function(){e.order.discounts.splice(t,1)}))},get agency(){return this.order.agency_data||{title:"",affiliate:"",manager_name:"",manager_phone:"",manager_email:""}},set agency(t){this.formChanged=!0,this.order.agency_data=t},get utmData(){return this.order.utm_data||{customer_source:"",customer_device:""}},set utmData(t){this.formChanged=!0,this.order.utm_data=t},get accommodation(){var t=this,e={other:this.order.accommodation&&this.order.accommodation.other||0,other_text:this.order.accommodation&&this.order.accommodation.other_text||""};return this.roomTypes.forEach((function(n){e[n.value]=t.order.accommodation?t.order.accommodation[n.value]:0})),e},set accommodation(t){this.formChanged=!0,this.order.accommodation=t},setAccommodationItem:function(t,e){this.order.accommodation||(this.order.accommodation={}),this.order.accommodation[t]=parseInt(e)||0},onFormChange:function(){var t=this;return ne(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.formChanged=!0;case 1:case"end":return e.stop()}}),e)})))()},onSubmit:function(){var t=this;return ne(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:te(t.$refs.form)&&(t.formChanged=!1,t.$refs.form.submit());case 1:case"end":return e.stop()}}),e)})))()},get childrenDiscounts(){return this.tourDiscounts.filter((function(t){return t.category.includes("children")}))},get childrenYoungFree(){return!!this.childrenDiscounts.find((function(t){return("children_young"===t.category||"children"===t.category)&&1===t.type&&100===t.price}))},get childrenOlderFree(){return!!this.childrenDiscounts.find((function(t){return("children_older"===t.category||"children"===t.category)&&1===t.type&&100===t.price}))},get totalPlaces(){var t=this.order.places||0;return this.order.children&&(t+=this.order.children_young||0,t+=this.order.children_older||0),t},get totalPayedPlaces(){var t=this.order.places||0;return this.order.children&&!this.childrenYoungFree&&(t+=this.order.children_young||0),this.order.children&&!this.childrenOlderFree&&(t+=this.order.children_older||0),t},get selectedSchedule(){var t=this;return this.order.schedule_id>0?this.schedules.find((function(e){return e.id===t.order.schedule_id})):null},get placePrice(){return this.selectedSchedule?this.selectedSchedule.price:this.tour?this.tour.price:0},get placeCommission(){return this.selectedSchedule?this.selectedSchedule.commission:this.tour?this.tour.commission:0},get accommPrice(){return this.selectedSchedule?this.selectedSchedule.accomm_price:this.tour?this.tour.accomm_price:0},get totalPrice(){return(this.order.price||0)-this.discountAmount+(this.order.accomm_price||0)-(this.order.commission||0)},calcSum:function(){0===this.totalPayedPlaces&&O.A.warning("Введіть кількість учасників"),0===this.placePrice&&O.A.warning("Оберіть дату виїзду");var t=this.accommodation["1o_sgl"]||0;this.order.accomm_price=t*this.accommPrice||0,this.order.price=this.totalPayedPlaces*this.placePrice||0,this.order.is_tour_agent?this.order.commission=this.totalPayedPlaces*this.placeCommission||0:this.order.commission=0},get isReserve(){return!this.order.id&&this.selectedSchedule&&this.selectedSchedule.places_available<this.totalPayedPlaces}}};function ce(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function ue(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){ce(a,r,i,o,s,"next",t)}function s(t){ce(a,r,i,o,s,"throw",t)}o(void 0)}))}}function de(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function le(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?de(Object(n),!0).forEach((function(e){he(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):de(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function he(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const me=function(t){var e,n,r,i,a,s;return{order:le(le({},t.order),{},{participants:{items:(null===(e=t.order)||void 0===e||null===(n=e.participants)||void 0===n?void 0:n.items)||[],participant_phone:(null===(r=t.order)||void 0===r||null===(i=r.participants)||void 0===i?void 0:i.participant_phone)||"",customer:(null===(a=t.order)||void 0===a||null===(s=a.participants)||void 0===s?void 0:s.customer)||!1}}),formChanged:!1,roomTypes:t.roomTypes||[],statuses:t.statuses,includes:t.includes,tour:null,participantData:{first_name:"",last_name:"",middle_name:"",birthday:""},discountIdx:null,discountData:{title:"",value:0},init:function(){var t=this;this.$watch("order",(function(){t.formChanged=!0})),setTimeout((function(){var e=document.getElementById("tourSelectBox");if(jQuery(e).select2({theme:"bootstrap-5",ajax:{url:"/api/tours/select-box",dataType:"json",data:function(t){return{attributes:["price","commission","accomm_price"],q:t.term,page:t.page||1,limit:20}}}}),jQuery(e).on("select2:select",(function(e){t.tour=e.params.data,t.order.tour_id=e.params.data.id})),console.log(t.$refs.pickerInput),console.log(t.$refs.startDateRef),console.log(t.$refs.endDateRef),t.$refs.pickerInput&&(0,W.Z)(t.$refs.pickerInput,{locale:G.Ukrainian,allowInput:!0,dateFormat:"d.m.Y"}),t.$refs.startDateRef)(0,W.Z)(t.$refs.startDateRef,{locale:G.Ukrainian,dateFormat:"d.m.Y"});if(t.$refs.endDateRef)(0,W.Z)(t.$refs.endDateRef,{locale:G.Ukrainian,dateFormat:"d.m.Y"})}),200),window.addEventListener("beforeunload",function(){var e=ue(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.formChanged&&(n.preventDefault(),n.returnValue="");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},get isCustomerParticipant(){return!!this.order.participants.customer},get participantPhone(){return this.order.participants?this.order.participants.participant_phone:""},set participantPhone(t){this.formChanged=!0,this.order.participants.participant_phone=t},get participants(){return this.order.participants?this.order.participants.items:[]},set participants(t){this.formChanged=!0,this.order.participants.items=t},addParticipant:function(){this.participantData.first_name&&(this.order.participants.items.push(le({},this.participantData)),this.participantData={first_name:"",last_name:"",middle_name:"",birthday:""})},removeParticipant:function(t){var e=this;Qt((function(){e.order.participants.items.splice(t,1)}))},get tourDiscounts(){var t;return(null===(t=this.tour)||void 0===t?void 0:t.discounts)||[]},get discounts(){return this.order.discounts||[]},set discounts(t){this.formChanged=!0,this.order.discounts=t},get discountAmount(){var t=0;return this.discounts.forEach((function(e){t+=parseInt(e.value)||0})),t},get discountModal(){return bootstrap.Modal.getOrCreateInstance(document.getElementById("edit-discount-modal"))},editDiscount:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.discountIdx=t,this.discountData=null!==t?{title:this.discounts[t].title,value:this.discounts[t].value}:{title:"",value:""},this.discountModal.show()},cancelDiscount:function(){this.discountModal.hide(),this.discountIdx=null,this.discountData={title:"",value:0}},saveDiscount:function(){var t=this.order.discounts||[],e={title:this.discountData.title,value:this.discountData.value};null!==this.discountIdx?t[this.discountIdx]=e:t.push(e),this.order.discounts=t,this.discountModal.hide()},deleteDiscount:function(t){var e=this;Qt((function(){e.order.discounts.splice(t,1)}))},get totalPrice(){return(this.order.price||0)-this.discountAmount+(this.order.accomm_price||0)},get totalPlaces(){var t=this.order.places||0;return this.order.children&&(t+=this.order.children_young||0),this.order.children&&(t+=this.order.children_older||0),t},get agency(){return this.order.agency_data||{title:"",affiliate:"",manager_name:"",manager_phone:"",manager_email:""}},set agency(t){this.formChanged=!0,this.order.agency_data=t},get utmData(){return this.order.utm_data||{customer_source:"",customer_device:""}},set utmData(t){this.formChanged=!0,this.order.utm_data=t},get accommodation(){var t=this,e={other:this.order.accommodation&&this.order.accommodation.other||0,other_text:this.order.accommodation&&this.order.accommodation.other_text||""};return this.roomTypes.forEach((function(n){e[n.value]=t.order.accommodation?t.order.accommodation[n.value]:0})),e},set accommodation(t){this.formChanged=!0,this.order.accommodation=t},onFormChange:function(t){var e=this;return ue(o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:console.log(t),e.formChanged=!0;case 2:case"end":return n.stop()}}),n)})))()},onSubmit:function(t){var e=this;return ue(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:te(e.$refs.form)&&(e.formChanged=!1,e.$refs.form.submit());case 1:case"end":return t.stop()}}),t)})))()},get placePrice(){return this.tour?this.tour.price:0},get placeCommission(){return this.tour?this.tour.commission:0},get accommPrice(){return this.tour?this.tour.accomm_price:0},calcSum:function(){0===this.totalPlaces&&O.A.warning("Введіть кількість учасників"),0===this.placePrice&&0===this.order.program_type&&O.A.warning("Оберіть тур"),this.order.accomm_price=(this.order.places||0)*this.accommPrice||0,this.order.price=this.totalPlaces*this.placePrice||0,this.order.commission=this.totalPlaces*this.placeCommission||0}}};function pe(t){return function(t){if(Array.isArray(t))return fe(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return fe(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fe(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fe(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}const ge=function(t){return{orderId:t,items:[],currentPage:1,hasMore:!1,request:!1,init:function(){this.loadItems()},loadItems:function(){var t=this;this.request=!0,p().get("/admin/crm/order/".concat(this.orderId,"/audits?page=").concat(this.currentPage)).then((function(e){var n=e.data;1===t.currentPage?t.items=n.data:t.items=[].concat(pe(t.items),pe(n.data)),t.hasMore=!!n.next_page_url,t.request=!1})).catch((function(e){Q(e),t.request=!1,t.hasMore=!1}))},loadMore:function(){this.request||(this.currentPage=this.currentPage+1,this.loadItems())},formattedDate:function(t){return K()(t).format("DD.MM.YYYY HH:mm")},changedFields:function(t){var e="";if("updated"===t.event){var n=[];for(var r in t.new_values){var i="",a=t.new_values[r];if(t.old_values[r]){var o=t.old_values[r];i+="".concat(r,": ").concat(o," => ").concat(a)}else i+="".concat(r,": ").concat(a);n.push(i)}e+=n.join(", ")}return e}}},ve=function(t,e){return{count:0,init:function(){this.checkCount()},checkCount:function(){var n=this;p().get("/admin/crm/order/count",{params:{status:t,group_type:e}}).then((function(t){var e=t.data;n.count=e}))}}},ye=function(t){return{order:t,updateOrder:function(t){N({url:"/admin/order/".concat(this.order.id),params:t,onSuccess:function(t){O.A.success(t.message)}})}}};function be(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return _e(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _e(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function _e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function we(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function je(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?we(Object(n),!0).forEach((function(e){Oe(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Oe(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const De=function(t){var e;return{order:t.order,tour:null!==(e=t.tour)&&void 0!==e?e:null,formChanged:!1,roomTypes:t.roomTypes||[],editableIds:[],accommodationsForm:je({other:t.order.accommodation&&t.order.accommodation.other||"",other_text:t.order.accommodation&&t.order.accommodation.other_text||""},t.roomTypes.reduce((function(e,n){return n[e.value]=t.order.accommodation&&t.order.accommodation[e.value]||"",n}),{})),isEditable:function(t){return this.editableIds.indexOf(t)>-1},editAccomm:function(t){this.isEditable(t)||(this.editableIds.push(t),this.accommodationsForm[t]=this.order.accommodation&&this.order.accommodation[t]||"")},saveAccomm:function(t){var e=this;this.updateAccomm(t,this.accommodationsForm[t]).then((function(){e.isEditable(t)&&e.editableIds.splice(e.editableIds.indexOf(t))}))},cancelAccomm:function(t){this.isEditable(t)&&this.editableIds.splice(this.editableIds.indexOf(t)),this.accommodationsForm[t]=this.order.accommodation[t]},updateAccomm:function(t,e){var n=this;return p().patch("/admin/order/".concat(this.order.id,"/accomm"),{id:t,value:e}).then((function(t){var e=t.data;n.order=e.model,n.accommodationsForm.other=n.order.accommodation&&n.order.accommodation.other||"",n.accommodationsForm.other_text=n.order.accommodation&&n.order.accommodation.other_text||"";var r,i=be(n.roomTypes);try{for(i.s();!(r=i.n()).done;){var a=r.value;n.accommodationsForm[a.value]=n.order.accommodation&&n.order.accommodation[a.value]||""}}catch(t){i.e(t)}finally{i.f()}O.A.success(e.message)})).catch((function(t){console.log(t)}))}}},xe=function(t){var e=t.order;return{editor:null,statuses:t.statuses||[],includes:t.includes||[],order:e,data:{first_name:e.first_name||"",last_name:e.last_name||"",phone:e.phone||"",email:e.email||"",viber:e.viber||"",company:e.company||"",start_date:e.start_date||"",start_place:e.start_place||"",end_date:e.end_date||"",end_place:e.end_place||"",program_type:e.program_type||0,tour_plan:e.tour_plan||"",tour_id:e.tour_id||null,places:e.places||null,children:e.children||!1,children_older:e.children_older||0,children_young:e.children_young||0,group_comment:e.group_comment||"",program_comment:e.program_comment||"",price_include:e.price_include||[]},status:e.status||"new",notifySend:!1,notifyEmail:e.email,notifyMessage:"",tour:e.tour||null,init:function(){var t=this;setTimeout((function(){var e=document.getElementById("tourSelectBox");jQuery(e).select2({theme:"bootstrap-5",ajax:{url:"/api/tours/select-box",dataType:"json",data:function(t){return{q:t.term,page:t.page||1,limit:20}}}}),jQuery(e).on("select2:select",(function(e){t.data.tour_id=e.params.data.id})),t.$watch("notifyEmail",(function(e){e?t.editor=M().init({selector:"#notify-message",language:"uk",toolbar:"undo redo | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent emoticons ",menubar:"",setup:function(e){e.on("Input",(function(n){t.notifyMessage=e.getContent()})),e.on("Change",(function(n){t.notifyMessage=e.getContent()}))}}):t.editor&&t.editor.destroy()}));(0,W.Z)(t.$refs.startDateRef,{locale:G.Ukrainian,dateFormat:"d.m.Y"}),(0,W.Z)(t.$refs.endDateRef,{locale:G.Ukrainian,dateFormat:"d.m.Y"})}),200)},get basicModal(){return bootstrap.Modal.getOrCreateInstance(document.getElementById("edit-basic-modal"))},get clientName(){return this.data.last_name+" "+this.data.first_name},get statusText(){var t=this,e=this.statuses.find((function(e){return e.value===t.status}));return e?e.text:"-"},get totalPlaces(){var t=this.data.places;return this.data.children&&(t+=this.data.children_young,t+=this.data.children_older),t},get includeTitle(){var t=this;return this.includes.filter((function(e){return-1!==t.data.price_include.indexOf(e.value)})).map((function(t){return t.text})).join(", ")},resetData:function(){this.data={first_name:this.order.first_name||"",last_name:this.order.last_name||"",phone:this.order.phone||"",email:this.order.email||"",viber:this.order.viber||"",company:this.order.company||"",start_date:this.order.start_date||"",start_place:this.order.start_place||"",end_date:this.order.end_date||"",end_place:this.order.end_place||"",program_type:this.order.program_type||0,tour_plan:this.order.tour_plan||"",tour_id:this.order.tour_id||null,places:this.order.places||null,children:this.order.children||!1,children_older:this.order.children_older||0,children_young:this.order.children_young||0,group_comment:this.order.group_comment||"",program_comment:this.order.program_comment||"",price_include:this.order.price_include||[]},this.status=this.order.status},updateOrder:function(){var t=this;p().patch("/admin/order/".concat(this.order.id),this.data).then((function(e){var n=e.data;t.basicModal.hide(),t.order=n.model,t.status=n.model.status,t.tour=n.model.tour||null,O.A.success(n.message)})).catch((function(t){console.log(t)}))},updateOrderStatus:function(){var t=this;p().patch("/admin/order/".concat(this.order.id,"/update-status"),{status:this.status,notifySend:this.notifySend,notifyEmail:this.notifyEmail,notifyMessage:this.notifyMessage}).then((function(e){var n=e.data;O.A.success(n.message),t.status=n.model.status})).catch((function(t){console.log(t)}))}}},Se=function(t){return{count:0,init:function(){this.checkCount()},checkCount:function(){var e=this;p().get("/admin/crm/transport/count",{params:{status:t}}).then((function(t){var n=t.data;e.count=n}))}}},Ae=function(t){return{count:0,init:function(){this.checkCount()},checkCount:function(){var e=this;p().get("/admin/crm/certificate/count",{params:{status:t}}).then((function(t){var n=t.data;e.count=n}))}}},ke=function(t){return{role:t.role,status:t.status,formData:{first_name:"",last_name:"",middle_name:""},init:function(){var t=this;this.$watch("formData",(function(e){e.first_name&&(t.formData.first_name=e.first_name.ucWords()),e.last_name&&(t.formData.last_name=e.last_name.ucWords()),e.middle_name&&(t.formData.middle_name=e.middle_name.ucWords())}))}}},Ce=function(t){return{init:function(){this.$store.crmUser.user=t.user||{}}}},Ie=function(t){return{request:!1,baseUrl:t.baseUrl||document.location.href,q:t.request.q||"",region_id:parseInt(t.request.region_id)||0,district_id:parseInt(t.request.district_id)||0,current_page:parseInt(t.request.page)||1,per_page:parseInt(t.request.per_page)||20,sort:t.request.order||"title->uk:desc",regions:t.regions||[],districts:t.districts||[],items:[],links:[],init:function(){this.loadItems(!1),this.region_id>0&&this.loadDistricts()},setPage:function(t){var e=g(t);this.current_page=e.page||1,this.loadItems(!0)},setSorting:function(t){this.sort=t,this.loadItems(!0)},loadItems:function(){var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.request=!0,z({url:this.baseUrl,params:{q:this.q,region_id:this.region_id,district_id:this.district_id,page:this.current_page,per_page:this.per_page,order:this.sort},updateUrl:e,defaultParams:{q:"",region_id:0,district_id:0,page:1,per_page:20,order:"title->uk:desc"},onSuccess:function(e){t.items=e.data,t.links=e.links,t.request=!1},onError:function(){t.request=!1}})},loadDistricts:function(){var t=this;p().get("/api/location/districts?region_id="+this.region_id).then((function(e){var n=e.data;t.districts=n}))},regionsChange:function(){this.page=1,this.district_id=0,this.region_id>0?this.loadDistricts():this.districts=[],this.loadItems()},filterChange:function(){this.current_page=1,this.loadItems()},updateItem:function(t,e){p().patch("/admin/place/"+t,e).then((function(t){var e=t.data;toast.success(e.message)}))},deleteItem:function(t){var e=this;H("/admin/place/".concat(t),(function(t){e.loadItems(!1)}))}}},Pe=function(t){return{page:{published:t.page.published||!1}}},Ee=function(t){return{options:t.options||[],items:t.items.map((function(t){return parseInt(t)})),managerId:0,managers:[],sortable:null,init:function(){var t=this;this.sortable=r.ZP.create(this.$refs.sortableRef,{handle:".handler",animation:150,onUpdate:function(e){var n=t.sortable.toArray();t.items=n.map((function(t){return parseInt(t)}))}}),this.managers=this.options.filter((function(e){return-1!==t.items.indexOf(e.value)})).sort((function(e,n){return t.items.indexOf(e.value)>t.items.indexOf(n.value)?1:t.items.indexOf(e.value)<t.items.indexOf(n.value)?-1:0}))},remove:function(t){var e=this.items.indexOf(t);e>-1&&(this.items.splice(e,1),this.managers=this.managers.filter((function(e){return e.value!==t})))},add:function(){var t=this;if(this.managerId>0&&-1===this.items.indexOf(this.managerId)){this.items.push(this.managerId);var e=this.options.find((function(e){return e.value===t.managerId}));this.managers.push(e)}}}},Me={editor:null,email:"",subject:"",message:"",show:function(t){var e=this;this.email=t,this.editor||(this.editor=M().init({selector:"#crm-email-message",language:"uk",toolbar:"undo redo | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent emoticons ",menubar:"",setup:function(t){t.on("Input",(function(n){e.message=t.getContent()})),t.on("Change",(function(n){e.message=t.getContent()}))}}))},send:function(){p().post("/admin/crm/notify/email",{email:this.email,subject:this.subject,message:this.message}).then((function(t){var e=t.data;"success"===e.result&&toast.success(e.message)})).catch((function(t){toast.error(t.message)}))},cancel:function(){this.email="",this.subject="",this.message=""}},Te={user:{},hasRole:function(t){return-1!==this.user.roles.indexOf(t)},get isMasterAdmin(){return this.hasRole("admin")&&1===this.user.id},get isAdmin(){return this.hasRole("admin")},get isManager(){return this.hasRole("manager")},get isTourManager(){return this.hasRole("tour-manager")},get isDutyManager(){return this.hasRole("duty-manager")}};var qe=n(5382),Le=n.n(qe);const Ue=function(t,e){var n=e.expression;Le()(n).mask(t)},$e=function(t){(0,W.Z)(t,{locale:G.Ukrainian,allowInput:!0,dateFormat:"d.m.Y",defaultDate:t.value})};function Be(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return Fe(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fe(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Fe(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}window.addEventListener("displayErrors",(function(t){var e;Object.values((null===(e=t.detail)||void 0===e?void 0:e.errors)||{}).forEach((function(t){var e,n=Be(t);try{for(n.s();!(e=n.n()).done;){var r=e.value;toast.error(r)}}catch(t){n.e(t)}finally{n.f()}}))})),document.addEventListener("alpine:init",(function(){Alpine.directive("datepicker",$e),Alpine.directive("mask",Ue),Alpine.store("crmEmail",Me),Alpine.store("crmUser",Te),Alpine.data("sortable",i),Alpine.data("translatable",h),Alpine.data("translations",x),Alpine.data("publishable",A),Alpine.data("tiny",U),Alpine.data("singleFileUpload",B),Alpine.data("tourPlaces",F),Alpine.data("tourTickets",Y),Alpine.data("tourFood",R),Alpine.data("tourSchedules",nt),Alpine.data("tourLanding",it),Alpine.data("menuEditor",at),Alpine.data("menuList",ut),Alpine.data("menuItem",ht),Alpine.data("tourFinance",rt),Alpine.data("crmClients",pt),Alpine.data("crmClient",yt),Alpine.data("crmClientOrders",bt),Alpine.data("crmSchedules",_t),Alpine.data("crmScheduleRow",wt),Alpine.data("crmScheduleItem",At),Alpine.data("crmOrderBasic",kt),Alpine.data("crmOrderCustomer",Ct),Alpine.data("crmOrderSchedule",Et),Alpine.data("crmOrderParticipants",Tt),Alpine.data("crmOrderAgency",Lt),Alpine.data("crmOrderFinance",Vt),Alpine.data("crmOrderOther",Kt),Alpine.data("crmOrderList",Jt),Alpine.data("crmOrderCollective",se),Alpine.data("crmOrderCorporate",me),Alpine.data("crmOrderBadge",ve),Alpine.data("crmOrderAudits",ge),Alpine.data("crmOrderAdditional",ye),Alpine.data("crmOrderAccom",De),Alpine.data("crmCorporateBasic",xe),Alpine.data("mediaLibrary",P),Alpine.data("userCollective",ke),Alpine.data("user",Ce),Alpine.data("placeList",Ie),Alpine.data("crmTransportBadge",Se),Alpine.data("crmCertificateBadge",Ae),Alpine.data("pageForm",Pe),Alpine.data("contactManagers",Ee)}))},5099:(t,e,n)=>{"use strict";n(2689),n(454),n(8531);var r=n(5169);window.bootstrap=r;try{document.addEventListener("DOMContentLoaded",(function(){Array.from(document.querySelectorAll(".toast")).forEach((function(t){new r.Toast(t).show(),t.addEventListener("hidden.bs.toast",(function(e){t.remove()}))}))}))}catch(t){console.log(t)}var i=n(7924),a=function(){if(document.getElementsByClassName("js-simplebar")[0]){var t=new i.Z(document.getElementsByClassName("js-simplebar")[0]);document.querySelectorAll(".js-sidebar [data-bs-parent]").forEach((function(e){e.addEventListener("shown.bs.collapse",(function(){t.recalculate()})),e.addEventListener("hidden.bs.collapse",(function(){t.recalculate()}))}))}},o=function(){var t=document.getElementsByClassName("js-sidebar")[0],e=document.getElementsByClassName("js-sidebar-toggle")[0];t&&e&&e.addEventListener("click",(function(){t.classList.toggle("collapsed"),t.addEventListener("transitionend",(function(){window.dispatchEvent(new Event("resize"))}))}))};document.addEventListener("DOMContentLoaded",(function(){return a(),void o()}));n(2823);var s=n(8508),c=n.n(s);document.addEventListener("DOMContentLoaded",(function(){c().replace()})),window.feather=c();n(8075);var u=n(7757),d=n.n(u);function l(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}function h(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){l(a,r,i,o,s,"next",t)}function s(t){l(a,r,i,o,s,"throw",t)}o(void 0)}))}}var m=function(t){var e="string"==typeof t?document.querySelector(t):t,n=e.querySelector(".media-sortable"),r=e.dataset.mediaStore||"#",i=e.dataset.mediaDestroy||"#",a=e.dataset.mediaUpdate||"#",o=e.dataset.mediaOrder||"#",s=e.dataset.mediaCollection||"default",c=e.dataset.mediaName||"media_file",u=e.querySelector('input[type="file"]'),l=(e.querySelector(".add-media"),null);u.addEventListener("change",(function(t){var e=t.target.files;e.length>0&&(Array.from(e).forEach(function(){var t=h(d().mark((function t(e){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y(e);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),u.value=null)})),e.querySelectorAll(".delete-media-item").forEach((function(t){t.addEventListener("click",(function(t){return g(t)}))})),e.querySelectorAll(".edit-media-title").forEach((function(t){t.addEventListener("blur",(function(t){return p(t)}))})),e.querySelectorAll(".edit-media-alt").forEach((function(t){t.addEventListener("blur",(function(t){return f(t)}))}));var m=function(){var t=h(d().mark((function t(e){var n,r,i=arguments;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:{},r=e.id.replace("media-item-",""),t.next=4,axios.patch(a.replace("0",r),n).then((function(t){t.data.result})).catch((function(t){console.log(t),e.classList.add("error"),e.innerHTML+='<span class="error">Update Error</span>'}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),p=function(){var t=h(d().mark((function t(e){var n,r,i;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.currentTarget,"#"!==a){t.next=3;break}return t.abrupt("return");case 3:return r=n.parentElement,i=n.value,t.next=7,m(r,{title:i});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),f=function(){var t=h(d().mark((function t(e){var n,r,i;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.currentTarget,"#"!==a){t.next=3;break}return t.abrupt("return");case 3:return r=n.parentElement,i=n.value,t.next=7,m(r,{alt:i});case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),g=function(){var t=h(d().mark((function t(e){var n,r,a;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.preventDefault(),"#"!==i){t.next=3;break}return t.abrupt("return");case 3:n=e.currentTarget,r=n.parentElement,a=r.id.replace("media-item-",""),axios.delete(i.replace("0",a)).then((function(t){"success"===t.data.result&&r.remove()})).catch((function(t){console.log(t),r.classList.add("error"),r.innerHTML+='<span class="error">Delete Error</span>'}));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),v=function(t,e){var r=document.createElement("div");r.classList.add("media-item","img-thumbnail"),r.id="media-item-"+t.id,r.dataset.id=t.id,r.setAttribute("data-id",t.id),r.innerHTML='<img src="'.concat(t.thumb,'" alt=""><a href="#" class="delete-media-item"><i class="fas fa-times"></i></a>\n        <a href="').concat(t.url,'" class="show-media-item" target="_blank" data-fancybox="').concat(s,'"><i class="fas fa-eye"></i></a>\n        <span class="handler fas fa-bars"></span>\n        <input class="edit-media-title" value="Change image title" />\n        <input class="edit-media-alt" value="Change image alt" />'),n.replaceChild(r,e),r.querySelector(".delete-media-item").addEventListener("click",(function(t){return g(t)})),r.querySelector(".edit-media-title").addEventListener("blur",(function(t){return p(t)})),r.querySelector(".edit-media-alt").addEventListener("blur",(function(t){return f(t)}))},y=function(){var t=h(d().mark((function t(e){var i,a,o;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=new FileReader,(a=document.createElement("div")).classList.add("media-item","media-tmp","img-thumbnail"),i.onload=function(t){var e=t.target.result;a.innerHTML='<img src="'.concat(e,'" alt=""><div class="spinner-border text-warning" role="status"></div>'),n.appendChild(a)},i.readAsDataURL(e),"#"!==r){t.next=7;break}return t.abrupt("return");case 7:return(o=new FormData).append(c,e),o.append("collection",s),t.next=12,axios.post(r,o,{headers:{"Content-Type":"multipart/form-data"}}).then((function(t){var e=t.data;"success"===e.result&&v(e.media,a)})).catch((function(t){console.log(t),a.classList.add("error"),a.querySelector(".spinner-border").remove(),a.innerHTML+='<span class="error">Upload Error</span>'}));case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();l=Sortable.create(n,{handle:".handler",animation:150,onUpdate:function(t){var e=l.toArray();axios.post(o,{order:e}).catch((function(t){console.log(t)}))}})};window.MediaLibrary=m,document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll("[data-media-upload]").forEach((function(t){new m(t)}))}));var p=n(4399);window.Swal=p.Z;var f=function(){this.init=function(){document.querySelectorAll("form[data-onsubmit-message]").forEach((function(t){t.querySelector('[type="submit"]').addEventListener("click",(function(e){var n=t.dataset.onsubmitMessage||"";if(n){e.preventDefault();var r=t.dataset.confirmText||"Так",i=t.dataset.cancelText||"Відмінити",a=t.dataset.showCancelButton||!0,o=t.dataset.icon||"warning";p.Z.fire({text:n,icon:o,showCancelButton:a,confirmButtonText:r,cancelButtonText:i}).then((function(e){e.value&&t.submit()}))}}))}))}};window.FormOnSubmitMessage=f,document.addEventListener("DOMContentLoaded",(function(){(new f).init()}));var g=n(8926),v=function(t){var e=document.createElement("textarea");e.value=t,e.setAttribute("readonly",""),e.style.position="absolute",e.style.left="-9999px",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)};window.copyToClipboard=v,document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll("[data-clip-copy]").forEach((function(t){t.addEventListener("click",(function(e){e.preventDefault();var n=t.dataset.clipCopy;v(n),g.A.success("Скопировано!")}))}))}));var y=n(4529),b=n.n(y);window.Choices=b(),document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".select-choices").forEach((function(t){var e=new(b())(t,{removeItemButton:!0});e.passedElement.element.addEventListener("change",(function(){e.getValue(!0)})),t.dataset.options=JSON.stringify(e.config.choices)}))}));var _=n(4772);window.PerfectScrollbar=_.Z,document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll("[data-ps]").forEach((function(t){var e=t.dataset.ps||{};new _.Z(t,e)}))}));var w=n(8408);window.Sortable=w.Z;var j=n(7432),O=n.n(j);O().defaults.global.defaultFontFamily="'Inter', 'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",window.Chart=O();var D=n(8187),x=n(3550),S=n.n(x),A=n(1193);window.flatpickr=D.Z;var k=function(){this.init=function(){document.querySelectorAll(".date-picker-group").forEach((function(t){var e=t.dataset.dateFormat||"d.m.Y",n=t.querySelector(".flatpicker");(0,D.Z)(n,{wrap:!0,locale:A.Ukrainian,dateFormat:e,allowInput:!0,onChange:function(t,e,n){n.close(),n._input.blur()}})}))}},C=function(){this.init=function(){document.querySelectorAll(".range-picker-group").forEach((function(t){var e=t.querySelector(".flatpicker-start"),n=t.querySelector(".flatpicker-end"),r=e.dataset.dateFormat||"Y-m-d";(0,D.Z)(e,{minDate:Date.now(),locale:A.Ukrainian,dateFormat:r,plugins:[new(S())({input:n})],onChange:function(t,n,r){console.log(e)}})}))}};window.DatePickerComponent=k,document.addEventListener("DOMContentLoaded",(function(){(new k).init(),(new C).init()}));n(1017);function I(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}var P,E=function(t){var e=t.querySelector(".form-check-input"),n=t.dataset.url;e.addEventListener("change",function(){var t,r=(t=d().mark((function t(r){var i;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=r.target.checked,e.disabled=!0,t.next=4,axios.patch(n,{published:i?1:0});case 4:e.disabled=!1,i?toast.success("Запис опубліковано"):toast.success("Запис знятий з публікації");case 6:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){I(a,r,i,o,s,"next",t)}function s(t){I(a,r,i,o,s,"throw",t)}o(void 0)}))});return function(t){return r.apply(this,arguments)}}())};function M(t,e,n,r,i,a,o){try{var s=t[a](o),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,i)}document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".published-switch").forEach((function(t){new E(t)}))}));var T,q=new(n(3311).a)({apiKey:"AIzaSyA2VrKbul0izeo7J6HmLCLr2AGX3IQa-K8",version:"weekly",libraries:["places"],language:"uk"}),L=48.7363835,U=31.46074611,$=function(){var t,e=(t=d().mark((function t(e,n){var r,i,a,o,s,c,u,l,h,m,p,f,g,v,y,b,_;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(_=function(){var t=new google.maps.Geocoder,e=i.options[i.selectedIndex].text;return new Promise((function(n,r){t.geocode({address:e},(function(t,e){if(e===google.maps.GeocoderStatus.OK){var r={lat:t[0].geometry.location.lat(),lng:t[0].geometry.location.lng()};n(r)}else alert("Request failed.")}))}))},T=e||T||document.querySelector(".location-group"),r=T.classList.contains("no-map"),i=T.querySelector('[name="city_id"]'),a=T.querySelector('[name="lat"]'),o=T.querySelector('[name="lng"]'),s=T.querySelector(".map"),r||!s){t.next=29;break}if(u=function(t){var e=window.event||e,n=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail));y.setZoom(y.getZoom()+n)},l=function(){y.setZoom(y.getZoom()+1)},!(i&&i.value&&null!=n&&null!==(c=n.detail)&&void 0!==c&&c.cityChanged&&a&&o)){t.next=19;break}return t.next=13,_();case 13:h=t.sent,m=h.lat,p=h.lng,a.value=m,o.value=p,window.Livewire.emit("locationChanged",{lat:m,lng:p});case 19:f=null!=a&&a.value?parseFloat(a.value):L,g=null!=o&&o.value?parseFloat(o.value):U,v={lat:f,lng:g},y=new P.Map(s,{zoom:6,center:v}),b=new P.Marker({position:v,map:y}),y.addListener("drag",(function(){b.setPosition(y.getCenter()),v={lat:y.getCenter().lat(),lng:y.getCenter().lng()},a&&o&&(a.value=v.lat,o.value=v.lng,window.Livewire.emit("locationChanged",v))})),y.addListener("dragend",(function(){a&&o&&(jQuery(a).trigger("change"),jQuery(o).trigger("change"))})),y.addListener("mousewheel",u,!0),y.addListener("DOMMouseScroll",u,!0),y.addListener("dblclick",l,!0);case 29:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){M(a,r,i,o,s,"next",t)}function s(t){M(a,r,i,o,s,"throw",t)}o(void 0)}))});return function(t,n){return e.apply(this,arguments)}}();window.LocationGroup=$,q.load().then((function(t){P=t.maps,document.querySelectorAll(".location-group").forEach((function(t){new $(t)}))})).catch((function(t){console.log(t)})),window.addEventListener("initLocation",(function(t){document.querySelectorAll(".location-group").forEach((function(e){new $(e,t)}))}));n(3016),n(1163),n(8439);var B=n(3239),F=n.n(B);window.ace=F(),n(7333),n(7579),window.$=window.jQuery=n(9755),n(2081)},3016:()=>{document.addEventListener("alpine:init",(function(){Alpine.data("select2")}))},1017:(t,e,n)=>{var r=n(4319);window.Pikadayi18n={ru:{previousMonth:"Предыдущий месяц",nextMonth:"Следующий месяц",months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],weekdays:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"],weekdaysShort:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"]}},window.Pikaday=r},8075:()=>{var t=function(t){var e="string"==typeof t?document.querySelector(t):t,n=e.querySelector(".old-file"),r=e.querySelector('input[type="file"]'),i=e.querySelector(".clear-image"),a=e.querySelector(".img-thumbnail");r&&(r.addEventListener("change",(function(t){var e=t.target.files;if(e.length>0){var n=e[0],r=new FileReader;r.onload=function(t){a.setAttribute("src",t.target.result),i.classList.remove("d-none")},r.readAsDataURL(n)}})),i.addEventListener("click",(function(t){t.preventDefault(),a.setAttribute("src","/img/no-image.png"),n.value="",r.value="",i.classList.add("d-none")})))};window.ImageUploadGroup=t,document.addEventListener("DOMContentLoaded",(function(){document.querySelectorAll(".image-upload-group").forEach((function(e){new t(e)}))}))},2823:()=>{window.theme={primary:"#3B7DDD",secondary:"#6c757d",success:"#1cbb8c",info:"#17a2b8",warning:"#fcb92c",danger:"#dc3545",white:"#fff","gray-100":"#f8f9fa","gray-200":"#e9ecef","gray-300":"#dee2e6","gray-400":"#ced4da","gray-500":"#adb5bd","gray-600":"#6c757d","gray-700":"#495057","gray-800":"#343a40","gray-900":"#212529",black:"#000"}},7333:(t,e,n)=>{window._=n(6486),window.axios=n(9669),window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",window.moment=n(381)},8926:(t,e,n)=>{"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}n.d(e,{A:()=>c});var a=window.bootstrap||n(5169);var o={message:"",type:"info",delay:1e4,container:".toast-container"},s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n,s;return e=t,s=[{key:"show",value:function(t){"string"==typeof t?t=Object.assign({},o,{message:t}):"object"===r(t)&&(t=Object.assign({},o,t));var e,n,i=function(t){return'\n        <div class="toast hide align-items-center text-white bg-'.concat(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",' border-0" role="alert" aria-live="assertive" aria-atomic="true">\n          <div class="d-flex">\n            <div class="toast-body">\n              ').concat(t,'\n            </div>\n            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Close"></button>\n          </div>\n        </div>\n        ')}(t.message,t.type),s=(e=i,(n=document.createElement("div")).innerHTML=e.trim(),n.firstChild);!1!==t.delay&&t.delay>0&&(s.dataset.bsDelay=t.delay);var c=document.querySelector(t.container);c&&c.appendChild(s),new a.Toast(s).show(),s.addEventListener("hidden.bs.toast",(function(t){s.remove()}))}},{key:"success",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4;this.show({message:t,delay:e,type:"success"})}},{key:"error",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4;this.show({message:t,delay:e,type:"danger"})}},{key:"warning",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4;this.show({message:t,delay:e,type:"warning"})}},{key:"info",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4;this.show({message:t,delay:e,type:"info"})}}],(n=null)&&i(e.prototype,n),s&&i(e,s),t}();document.addEventListener("DOMContentLoaded",(function(t){window.toastsData&&window.toastsData.forEach((function(t){s.show(t)}))})),window.toast=s;var c=s;window.addEventListener("notify",(function(t){var e=t.detail.type,n=t.detail.message;"function"==typeof c[e]?c[e](n):c.info(n)}))},8295:()=>{},6700:(t,e,n)=>{var r={"./af":2786,"./af.js":2786,"./ar":867,"./ar-dz":4130,"./ar-dz.js":4130,"./ar-kw":6135,"./ar-kw.js":6135,"./ar-ly":6440,"./ar-ly.js":6440,"./ar-ma":7702,"./ar-ma.js":7702,"./ar-sa":6040,"./ar-sa.js":6040,"./ar-tn":7100,"./ar-tn.js":7100,"./ar.js":867,"./az":1083,"./az.js":1083,"./be":9808,"./be.js":9808,"./bg":8338,"./bg.js":8338,"./bm":7438,"./bm.js":7438,"./bn":8905,"./bn-bd":6225,"./bn-bd.js":6225,"./bn.js":8905,"./bo":1560,"./bo.js":1560,"./br":1278,"./br.js":1278,"./bs":622,"./bs.js":622,"./ca":2468,"./ca.js":2468,"./cs":5822,"./cs.js":5822,"./cv":877,"./cv.js":877,"./cy":7373,"./cy.js":7373,"./da":4780,"./da.js":4780,"./de":9740,"./de-at":217,"./de-at.js":217,"./de-ch":894,"./de-ch.js":894,"./de.js":9740,"./dv":5300,"./dv.js":5300,"./el":837,"./el.js":837,"./en-au":8348,"./en-au.js":8348,"./en-ca":7925,"./en-ca.js":7925,"./en-gb":2243,"./en-gb.js":2243,"./en-ie":6436,"./en-ie.js":6436,"./en-il":7207,"./en-il.js":7207,"./en-in":4175,"./en-in.js":4175,"./en-nz":6319,"./en-nz.js":6319,"./en-sg":1662,"./en-sg.js":1662,"./eo":2915,"./eo.js":2915,"./es":7093,"./es-do":5251,"./es-do.js":5251,"./es-mx":6112,"./es-mx.js":6112,"./es-us":1146,"./es-us.js":1146,"./es.js":7093,"./et":5603,"./et.js":5603,"./eu":7763,"./eu.js":7763,"./fa":6959,"./fa.js":6959,"./fi":1897,"./fi.js":1897,"./fil":2549,"./fil.js":2549,"./fo":4694,"./fo.js":4694,"./fr":4470,"./fr-ca":3049,"./fr-ca.js":3049,"./fr-ch":2330,"./fr-ch.js":2330,"./fr.js":4470,"./fy":5044,"./fy.js":5044,"./ga":9295,"./ga.js":9295,"./gd":2101,"./gd.js":2101,"./gl":8794,"./gl.js":8794,"./gom-deva":7884,"./gom-deva.js":7884,"./gom-latn":3168,"./gom-latn.js":3168,"./gu":5349,"./gu.js":5349,"./he":4206,"./he.js":4206,"./hi":94,"./hi.js":94,"./hr":316,"./hr.js":316,"./hu":2138,"./hu.js":2138,"./hy-am":1423,"./hy-am.js":1423,"./id":9218,"./id.js":9218,"./is":135,"./is.js":135,"./it":626,"./it-ch":150,"./it-ch.js":150,"./it.js":626,"./ja":9183,"./ja.js":9183,"./jv":4286,"./jv.js":4286,"./ka":2105,"./ka.js":2105,"./kk":7772,"./kk.js":7772,"./km":8758,"./km.js":8758,"./kn":9282,"./kn.js":9282,"./ko":3730,"./ko.js":3730,"./ku":1408,"./ku.js":1408,"./ky":3291,"./ky.js":3291,"./lb":6841,"./lb.js":6841,"./lo":5466,"./lo.js":5466,"./lt":7010,"./lt.js":7010,"./lv":7595,"./lv.js":7595,"./me":9861,"./me.js":9861,"./mi":5493,"./mi.js":5493,"./mk":5966,"./mk.js":5966,"./ml":7341,"./ml.js":7341,"./mn":5115,"./mn.js":5115,"./mr":370,"./mr.js":370,"./ms":9847,"./ms-my":1237,"./ms-my.js":1237,"./ms.js":9847,"./mt":2126,"./mt.js":2126,"./my":6165,"./my.js":6165,"./nb":4924,"./nb.js":4924,"./ne":6744,"./ne.js":6744,"./nl":3901,"./nl-be":9814,"./nl-be.js":9814,"./nl.js":3901,"./nn":3877,"./nn.js":3877,"./oc-lnc":2135,"./oc-lnc.js":2135,"./pa-in":5858,"./pa-in.js":5858,"./pl":4495,"./pl.js":4495,"./pt":9520,"./pt-br":7971,"./pt-br.js":7971,"./pt.js":9520,"./ro":6459,"./ro.js":6459,"./ru":238,"./ru.js":238,"./sd":950,"./sd.js":950,"./se":490,"./se.js":490,"./si":124,"./si.js":124,"./sk":4249,"./sk.js":4249,"./sl":4985,"./sl.js":4985,"./sq":1104,"./sq.js":1104,"./sr":9131,"./sr-cyrl":9915,"./sr-cyrl.js":9915,"./sr.js":9131,"./ss":5893,"./ss.js":5893,"./sv":8760,"./sv.js":8760,"./sw":1172,"./sw.js":1172,"./ta":1044,"./ta.js":1044,"./te":3110,"./te.js":3110,"./tet":2095,"./tet.js":2095,"./tg":7321,"./tg.js":7321,"./th":9041,"./th.js":9041,"./tk":9005,"./tk.js":9005,"./tl-ph":5768,"./tl-ph.js":5768,"./tlh":9444,"./tlh.js":9444,"./tr":2397,"./tr.js":2397,"./tzl":8254,"./tzl.js":8254,"./tzm":1106,"./tzm-latn":699,"./tzm-latn.js":699,"./tzm.js":1106,"./ug-cn":9288,"./ug-cn.js":9288,"./uk":7691,"./uk.js":7691,"./ur":3795,"./ur.js":3795,"./uz":6791,"./uz-latn":588,"./uz-latn.js":588,"./uz.js":6791,"./vi":5666,"./vi.js":5666,"./x-pseudo":4378,"./x-pseudo.js":4378,"./yo":5805,"./yo.js":5805,"./zh-cn":3839,"./zh-cn.js":3839,"./zh-hk":5726,"./zh-hk.js":5726,"./zh-mo":9807,"./zh-mo.js":9807,"./zh-tw":4152,"./zh-tw.js":4152};function i(t){var e=a(t);return n(e)}function a(t){if(!n.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}i.keys=function(){return Object.keys(r)},i.resolve=a,t.exports=i,i.id=6700}},t=>{"use strict";var e=e=>t(t.s=e);t.O(0,[703,898],(()=>(e(5099),e(8295))));t.O()}]);